<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dalmex Fiber Hub AI</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--primary:#10b981;--primary-dark:#059669;--purple:#8b5cf6;--purple-dark:#7c3aed;--danger:#ef4444;--warning:#f59e0b;--light:#dcfce7;--card:rgba(255,255,255,0.95);--text:#1e293b;--muted:#64748b}
        body{font-family:'Plus Jakarta Sans',sans-serif;background:linear-gradient(135deg,#f0fdf4,#ecfdf5,#d1fae5);min-height:100vh;color:var(--text)}
        .hidden{display:none!important}
        .login-screen{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
        .login-card{background:var(--card);border-radius:24px;padding:40px;width:100%;max-width:400px;box-shadow:0 25px 50px rgba(0,0,0,0.15)}
        .login-logo{width:80px;height:80px;background:linear-gradient(135deg,var(--purple),var(--purple-dark));border-radius:20px;display:flex;align-items:center;justify-content:center;font-size:40px;margin:0 auto 20px}
        .login-title{text-align:center;font-size:26px;font-weight:800;margin-bottom:8px}
        .login-subtitle{text-align:center;color:var(--muted);margin-bottom:24px}
        .form-group{margin-bottom:16px}
        .form-label{display:block;font-size:11px;font-weight:700;color:var(--muted);margin-bottom:6px;text-transform:uppercase}
        .form-input,.form-select{width:100%;padding:12px;border:2px solid #e2e8f0;border-radius:10px;font-size:15px;font-family:inherit}
        .form-input:focus,.form-select:focus{outline:none;border-color:var(--purple)}
        .btn{padding:12px 20px;border:none;border-radius:10px;font-size:14px;font-weight:700;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;gap:6px}
        .btn-purple{background:linear-gradient(135deg,var(--purple),var(--purple-dark));color:white}
        .btn-green{background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:white}
        .btn-gray{background:#f1f5f9;color:var(--text)}
        .btn-danger{background:var(--danger);color:white}
        .btn-full{width:100%;margin-bottom:10px}
        .login-error{background:#fef2f2;color:#dc2626;padding:12px;border-radius:8px;margin-bottom:16px;display:none}
        .login-error.show{display:block}
        .login-footer{text-align:center;margin-top:20px;font-size:11px;color:var(--muted)}
        .lang-toggle{display:flex;justify-content:center;gap:8px;margin-bottom:20px}
        .lang-btn{padding:8px 16px;border:2px solid #e2e8f0;border-radius:8px;background:white;font-size:13px;font-weight:600;cursor:pointer}
        .lang-btn.active{border-color:var(--purple);background:linear-gradient(135deg,var(--purple),var(--purple-dark));color:white}
        .app{display:none}
        .app.active{display:block}
        .ticker{background:linear-gradient(90deg,#0f172a,#1e293b);padding:10px 0;overflow:hidden}
        .ticker-track{display:flex;animation:scroll 50s linear infinite;white-space:nowrap}
        @keyframes scroll{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}
        .ticker-item{display:inline-flex;align-items:center;gap:8px;margin-right:40px;color:#f1f5f9;font-size:12px}
        .ticker-tag{padding:2px 6px;border-radius:4px;font-size:9px;font-weight:700}
        .ticker-tag.price{background:var(--warning)}
        .ticker-tag.news{background:#3b82f6}
        .ticker-tag.alert{background:var(--danger)}
        .header{background:var(--card);padding:12px 20px;border-bottom:1px solid #e2e8f0;position:sticky;top:0;z-index:100}
        .header-inner{max-width:1400px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px}
        .header-left{display:flex;align-items:center;gap:10px}
        .logo{width:42px;height:42px;background:linear-gradient(135deg,var(--purple),var(--purple-dark));border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:22px}
        .brand h1{font-size:18px;font-weight:800}
        .brand span{font-size:11px;color:var(--muted)}
        .header-right{display:flex;align-items:center;gap:8px}
        .user-badge{background:var(--light);padding:6px 12px;border-radius:8px;font-size:11px;font-weight:600;color:var(--primary-dark)}
        .nav{display:flex;gap:6px;padding:12px 20px;max-width:1400px;margin:0 auto;overflow-x:auto}
        .nav-btn{padding:8px 14px;background:white;border:1px solid #e2e8f0;border-radius:8px;font-size:12px;font-weight:600;cursor:pointer;white-space:nowrap}
        .nav-btn:hover{background:#f8fafc}
        .nav-btn.active{background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:white;border:none}
        .nav-btn.ai{background:linear-gradient(135deg,var(--purple),var(--purple-dark));color:white;border:none}
        .main{max-width:1400px;margin:0 auto;padding:0 20px 30px}
        .grid{display:grid;gap:16px}
        .grid-2{grid-template-columns:repeat(auto-fit,minmax(200px,1fr))}
        .grid-3{grid-template-columns:repeat(auto-fill,minmax(300px,1fr))}
        .card{background:var(--card);border-radius:16px;padding:18px;border:1px solid #e2e8f0}
        .card:hover{box-shadow:0 8px 25px rgba(0,0,0,0.08)}
        .card.priority{border-left:4px solid var(--warning)}
        .card-header{display:flex;justify-content:space-between;align-items:start;margin-bottom:10px}
        .avatar{width:42px;height:42px;background:linear-gradient(135deg,var(--primary),var(--primary-dark));border-radius:10px;display:flex;align-items:center;justify-content:center;color:white;font-weight:700}
        .badges{display:flex;flex-direction:column;gap:4px;align-items:flex-end}
        .badge{padding:3px 8px;border-radius:5px;font-size:9px;font-weight:700;text-transform:uppercase}
        .badge-mill{background:#dbeafe;color:#1d4ed8}
        .badge-broker{background:#fef3c7;color:#92400e}
        .badge-export{background:#ede9fe;color:#6d28d9}
        .badge-priority{background:#fef3c7;color:#b45309}
        .card-title{font-size:15px;font-weight:700;margin-bottom:2px}
        .card-subtitle{font-size:12px;color:var(--primary-dark);font-weight:600;margin-bottom:8px}
        .card-info{font-size:11px;color:var(--muted);line-height:1.6;margin-bottom:8px}
        .tags{display:flex;flex-wrap:wrap;gap:4px;margin-bottom:8px}
        .tag{background:var(--light);color:var(--primary-dark);padding:3px 7px;border-radius:4px;font-size:9px;font-weight:600}
        .prices{display:flex;flex-wrap:wrap;gap:6px;padding-top:8px;border-top:1px solid #f1f5f9;margin-bottom:10px}
        .price{background:#f0fdf4;padding:4px 8px;border-radius:6px;font-size:10px;font-weight:600;color:var(--primary-dark)}
        .card-actions{display:flex;gap:6px}
        .card-actions .btn{flex:1;padding:8px;font-size:11px}
        .stat-card{text-align:center}
        .stat-icon{font-size:28px;margin-bottom:6px}
        .stat-value{font-size:28px;font-weight:800}
        .stat-label{font-size:11px;color:var(--muted)}
        .section-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px;flex-wrap:wrap;gap:10px}
        .section-title{font-size:16px;font-weight:700}
        .ai-container{display:grid;grid-template-columns:1fr 320px;gap:16px}
        @media(max-width:900px){.ai-container{grid-template-columns:1fr}}
        .chat-panel{background:var(--card);border-radius:16px;overflow:hidden;border:1px solid #e2e8f0;display:flex;flex-direction:column}
        .chat-header{background:linear-gradient(135deg,var(--purple),var(--purple-dark));padding:14px 18px;color:white;display:flex;align-items:center;gap:10px}
        .chat-avatar{width:38px;height:38px;background:rgba(255,255,255,0.2);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px}
        .chat-title{font-size:15px;font-weight:700}
        .chat-status{font-size:11px;opacity:0.9}
        .chat-messages{flex:1;padding:14px;overflow-y:auto;max-height:400px;min-height:300px}
        .msg{display:flex;gap:10px;margin-bottom:12px;max-width:90%}
        .msg.user{margin-left:auto;flex-direction:row-reverse}
        .msg-avatar{width:30px;height:30px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0}
        .msg.ai .msg-avatar{background:var(--purple)}
        .msg.user .msg-avatar{background:var(--primary)}
        .msg-content{padding:10px 14px;border-radius:12px;font-size:13px;line-height:1.5}
        .msg.ai .msg-content{background:#f1f5f9}
        .msg.user .msg-content{background:var(--primary);color:white}
        .chat-input-area{padding:12px;border-top:1px solid #e2e8f0;display:flex;gap:8px}
        .chat-input{flex:1;padding:10px 14px;border:2px solid #e2e8f0;border-radius:10px;font-size:13px;font-family:inherit}
        .chat-input:focus{outline:none;border-color:var(--purple)}
        .sidebar{display:flex;flex-direction:column;gap:14px}
        .sidebar-card{background:var(--card);border-radius:14px;padding:16px;border:1px solid #e2e8f0}
        .sidebar-title{font-size:13px;font-weight:700;margin-bottom:12px}
        .quick-btn{width:100%;padding:10px 12px;background:#f8fafc;border:1px solid #e2e8f0;border-radius:8px;font-size:11px;cursor:pointer;text-align:left;margin-bottom:6px;display:flex;align-items:center;gap:8px}
        .quick-btn:hover{background:var(--light);border-color:var(--primary)}
        .rec-card{background:linear-gradient(135deg,rgba(139,92,246,0.1),rgba(124,58,237,0.05));border:1px solid rgba(139,92,246,0.2);border-radius:10px;padding:10px;margin-bottom:8px}
        .rec-label{font-size:9px;color:var(--purple);font-weight:700;text-transform:uppercase}
        .rec-value{font-size:18px;font-weight:800}
        .rec-detail{font-size:10px;color:var(--muted)}
        .market-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:10px;margin-bottom:16px}
        .market-card{background:var(--card);border-radius:10px;padding:14px;text-align:center;border:1px solid #e2e8f0}
        .market-code{font-size:11px;font-weight:700;color:var(--muted)}
        .market-price{font-size:18px;font-weight:800;color:var(--primary-dark)}
        .market-change{font-size:10px;font-weight:600}
        .market-change.up{color:#15803d}
        .market-change.down{color:#dc2626}
        .search-bar{display:flex;gap:8px;margin-bottom:14px;flex-wrap:wrap}
        .search-input{flex:1;min-width:200px;padding:10px 14px;border:2px solid #e2e8f0;border-radius:10px;font-size:13px;font-family:inherit}
        .search-input:focus{outline:none;border-color:var(--primary)}
        .filter-btn{padding:10px 14px;background:white;border:2px solid #e2e8f0;border-radius:10px;font-size:12px;font-weight:600;cursor:pointer}
        .filter-btn.active{border-color:var(--primary);background:var(--light)}
        .news-item{background:var(--card);border-radius:12px;padding:14px;border:1px solid #e2e8f0;margin-bottom:12px}
        .news-date{font-size:10px;color:var(--muted);margin-bottom:4px}
        .news-title{font-size:13px;font-weight:700;margin-bottom:6px}
        .news-excerpt{font-size:11px;color:var(--muted);line-height:1.5}
        .table-wrap{background:var(--card);border-radius:14px;overflow:hidden;border:1px solid #e2e8f0}
        .table-header{background:linear-gradient(135deg,#1e293b,#334155);padding:12px 16px;color:white;font-weight:700;font-size:14px}
        .table-scroll{overflow-x:auto}
        table{width:100%;border-collapse:collapse;min-width:600px}
        th{background:#f8fafc;padding:10px 8px;text-align:center;font-size:10px;font-weight:700;color:var(--muted);text-transform:uppercase}
        th:first-child{text-align:left}
        td{padding:10px 8px;text-align:center;border-bottom:1px solid #f1f5f9;font-size:12px}
        td:first-child{text-align:left}
        tr:hover{background:#f8fafc}
        .price-best{background:#dcfce7;color:#15803d;padding:4px 8px;border-radius:5px;font-weight:700}
        .modal-overlay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);z-index:1000;align-items:center;justify-content:center;padding:20px}
        .modal-overlay.active{display:flex}
        .modal{background:white;border-radius:20px;padding:24px;width:100%;max-width:480px;max-height:90vh;overflow-y:auto}
        .modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
        .modal-title{font-size:18px;font-weight:700}
        .modal-close{width:32px;height:32px;background:#f1f5f9;border:none;border-radius:8px;font-size:16px;cursor:pointer}
        .checkbox-group{display:flex;flex-wrap:wrap;gap:10px;margin-top:6px}
        .checkbox-item{display:flex;align-items:center;gap:6px;font-size:12px}
        .checkbox-item input{width:16px;height:16px}
        .footer{background:var(--card);border-top:1px solid #e2e8f0;padding:14px 20px;margin-top:30px;text-align:center;font-size:11px;color:var(--muted)}
        .toast{position:fixed;bottom:20px;right:20px;background:#1e293b;color:white;padding:12px 18px;border-radius:10px;font-size:13px;z-index:2000;display:none}
        .toast.show{display:block;animation:slideIn 0.3s ease}
        @keyframes slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}
    </style>
</head>
<body>
<div class="login-screen" id="loginScreen">
    <div class="login-card">
        <div class="login-logo">ü§ñ</div>
        <h1 class="login-title">Dalmex Fiber Hub</h1>
        <p class="login-subtitle" data-en="AI-Powered Paper Trading" data-es="Comercio de Papel con IA">AI-Powered Paper Trading</p>
        <div class="lang-toggle">
            <button class="lang-btn active" onclick="setLang('en')">üá∫üá∏ English</button>
            <button class="lang-btn" onclick="setLang('es')">üá≤üáΩ Espa√±ol</button>
        </div>
        <div class="login-error" id="loginError">Invalid username or password</div>
        <div class="form-group">
            <label class="form-label" data-en="Username" data-es="Usuario">Username</label>
            <input type="text" id="username" class="form-input" placeholder="Enter username">
        </div>
        <div class="form-group">
            <label class="form-label" data-en="Password" data-es="Contrase√±a">Password</label>
            <input type="password" id="password" class="form-input" placeholder="Enter password">
        </div>
        <button class="btn btn-purple btn-full" onclick="handleLogin()" data-en="Sign In" data-es="Iniciar Sesi√≥n">Sign In</button>
        <button class="btn btn-green btn-full" onclick="quickLogin()">‚ö° Quick Access</button>
        <div class="login-footer">
            <strong>Dalmex Recycling LLC</strong><br>
            2828 Nagle St. Dallas, TX 75220 ‚Ä¢ 214-352-2000
        </div>
    </div>
</div>
<div class="app" id="app">
    <div class="ticker">
        <div class="ticker-track" id="ticker"></div>
    </div>
    <header class="header">
        <div class="header-inner">
            <div class="header-left">
                <div class="logo">ü§ñ</div>
                <div class="brand"><h1>Dalmex Fiber Hub</h1><span>Enterprise AI ‚Ä¢ Dallas, TX</span></div>
            </div>
            <div class="header-right">
                <button class="lang-btn" onclick="setLang(lang==='en'?'es':'en')" id="langToggle">üá≤üáΩ Espa√±ol</button>
                <div class="user-badge" id="userBadge">User</div>
                <button class="btn btn-danger" onclick="logout()" style="padding:6px 12px;font-size:11px">Logout</button>
            </div>
        </div>
    </header>
    <nav class="nav" id="nav"></nav>
    <main class="main" id="main"></main>
    <footer class="footer">¬© 2025 Dalmex Recycling LLC ‚Ä¢ Created by Robert Vandling ‚Ä¢ AI-Powered by Claude</footer>
</div>
<div class="modal-overlay" id="addModal">
    <div class="modal">
        <div class="modal-header">
            <h3 class="modal-title" data-en="Add Contact" data-es="Agregar Contacto">Add Contact</h3>
            <button class="modal-close" onclick="closeModal()">‚úï</button>
        </div>
        <form id="contactForm">
            <div class="form-group">
                <label class="form-label">Company *</label>
                <input type="text" id="fCompany" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Contact Person *</label>
                <input type="text" id="fContact" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Email *</label>
                <input type="email" id="fEmail" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Phone</label>
                <input type="tel" id="fPhone" class="form-input">
            </div>
            <div class="form-group">
                <label class="form-label">Type *</label>
                <select id="fType" class="form-select" required>
                    <option value="">Select...</option>
                    <option value="Mill">Mill</option>
                    <option value="Broker">Broker</option>
                    <option value="Export">Export</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Commodities</label>
                <div class="checkbox-group">
                    <label class="checkbox-item"><input type="checkbox" name="comm" value="OCC"> OCC</label>
                    <label class="checkbox-item"><input type="checkbox" name="comm" value="PM"> PM</label>
                    <label class="checkbox-item"><input type="checkbox" name="comm" value="SWL"> SWL</label>
                    <label class="checkbox-item"><input type="checkbox" name="comm" value="DLK"> DLK</label>
                    <label class="checkbox-item"><input type="checkbox" name="comm" value="SOP"> SOP</label>
                    <label class="checkbox-item"><input type="checkbox" name="comm" value="HWEC"> HWEC</label>
                </div>
            </div>
            <div class="form-group">
                <label class="checkbox-item"><input type="checkbox" id="fPriority"> Priority Contact</label>
            </div>
            <div class="form-group">
                <label class="form-label">Notes</label>
                <input type="text" id="fNotes" class="form-input">
            </div>
            <div style="display:flex;gap:10px;margin-top:16px">
                <button type="button" class="btn btn-gray" style="flex:1" onclick="closeModal()">Cancel</button>
                <button type="submit" class="btn btn-green" style="flex:1">Save</button>
            </div>
        </form>
    </div>
</div>
<div class="toast" id="toast"></div>
<script>
const defaultBuyers=[
{id:1,company:"Georgia Pacific",contact:"Jake Walker",email:"jacob.walker1@gapac.com",phone:"(404) 652-4000",type:"Mill",priority:true,commodities:["OCC","DLK","PM","SOP","SWL","HWEC"],prices:{OCC:65,PM:155,SWL:215,DLK:90,SOP:150,HWEC:370},notes:"World's largest de-ink fiber user"},
{id:2,company:"Smurfit Westrock",contact:"Cynthia Torres",email:"cynthia.torres@smurfitwestrock.com",phone:"(972) 686-7649",type:"Mill",priority:true,commodities:["OCC","PM"],prices:{OCC:60,PM:180},notes:"LOCAL - Best PM at $180!"},
{id:3,company:"Greenside (Goldbergs)",contact:"Casandra Espinoza",email:"grupocartonero.mty@gmail.com",phone:"+52 81 8123-4567",type:"Export",priority:true,commodities:["OCC","PM","SWL"],prices:{OCC:58,PM:165,SWL:215},notes:"Mexico export"},
{id:4,company:"American Fiber",contact:"Steve Minor",email:"SMinor@amfiberservices.com",phone:"(678) 555-1234",type:"Broker",priority:true,commodities:["OCC","PM","SWL","HWEC"],prices:{OCC:62,PM:160,SWL:220,HWEC:365},notes:"Best SWL at $220!"},
{id:5,company:"Graphic Packaging - Waco",contact:"Fiber Procurement",email:"fiberprocurement@graphicpkg.com",phone:"(770) 240-7200",type:"Mill",priority:true,commodities:["OCC","Mixed Paper"],prices:{OCC:70,PM:55},notes:"NEW MILL 2026! Best OCC $70!"},
{id:6,company:"Green Bay Packaging",contact:"Fiber Procurement",email:"info@gbp.com",phone:"(501) 354-2131",type:"Mill",priority:true,commodities:["OCC"],prices:{OCC:68},notes:"$1B expansion!"},
{id:7,company:"Pratt Industries",contact:"Fiber Procurement",email:"recyclingcs@prattindustries.com",phone:"(888) 347-7288",type:"Mill",priority:false,commodities:["OCC","Mixed Paper"],prices:{OCC:65,PM:50},notes:"100% recycled"},
{id:8,company:"International Paper",contact:"Recycling Division",email:"recycling@ipaper.com",phone:"(972) 245-3000",type:"Mill",priority:false,commodities:["OCC","DLK","SOP","PM"],prices:{OCC:65,PM:52,DLK:95,SOP:145},notes:"LOCAL Carrollton"},
{id:9,company:"Texas Recycling",contact:"Joel/Craig Litman",email:"info@texasrecycling.com",phone:"(214) 357-0262",type:"Broker",priority:false,commodities:["OCC","PM","SOP","SWL"],prices:{OCC:62,PM:48,SWL:205,SOP:140},notes:"25+ years DFW"}
];
const marketPrices=[{code:"OCC",price:77,range:"$70-85",change:-5},{code:"PM",price:50,range:"$45-55",change:3},{code:"SWL",price:210,range:"$195-225",change:-10},{code:"DLK",price:92,range:"$85-100",change:0},{code:"SOP",price:145,range:"$135-155",change:5},{code:"HWEC",price:375,range:"$350-400",change:15}];
const news=[{date:"Dec 30, 2025",title:"OCC Prices to Rise Q1 2026",titleEs:"Precios OCC Subir√°n Q1 2026",excerpt:"Mill closures point to tighter supply",excerptEs:"Cierres de molinos apuntan a menor oferta"},{date:"Dec 28, 2025",title:"Graphic Packaging Waco Update",titleEs:"Actualizaci√≥n Graphic Packaging Waco",excerpt:"New 550K TPY facility on track for 2026",excerptEs:"Nueva planta 550K TPY en camino para 2026"},{date:"Dec 26, 2025",title:"10% NA Capacity Eliminated",titleEs:"10% Capacidad NA Eliminada",excerpt:"2025 closures reshape market",excerptEs:"Cierres 2025 reforman el mercado"}];
const tickerItems=[{type:"price",text:"üí∞ OCC: $70-85/ton"},{type:"price",text:"üìÑ PM: $45-55/ton"},{type:"news",text:"üì∞ Graphic Packaging Waco 2026"},{type:"alert",text:"üö® 10% NA capacity eliminated"},{type:"price",text:"üíé HWEC: $350-400/ton"}];
const users=[{id:1,username:"Dalmex",password:"2828",role:"user",name:"Dalmex User"},{id:2,username:"RJVandling",password:"Sailer66",role:"admin",name:"Robert Vandling"}];
const T={en:{ai:"AI Assistant",dash:"Dashboard",contacts:"Contacts",prices:"Prices",news:"News",add:"Add Contact",search:"Search...",all:"All",mills:"Mills",brokers:"Brokers",bestOCC:"Best OCC",bestSWL:"Best SWL",bestPM:"Best PM",quick:"Quick Actions",best:"Best Prices",who:"Who pays most for OCC?",swl:"Best for SWL?",addNew:"Add new contact",email:"Draft email",ppi:"PPI Report",outlook:"Market outlook",compare:"Price Comparison",industry:"Industry News"},es:{ai:"Asistente IA",dash:"Panel",contacts:"Contactos",prices:"Precios",news:"Noticias",add:"Agregar",search:"Buscar...",all:"Todos",mills:"Molinos",brokers:"Brokers",bestOCC:"Mejor OCC",bestSWL:"Mejor SWL",bestPM:"Mejor PM",quick:"Acciones",best:"Mejores Precios",who:"¬øQui√©n paga m√°s por OCC?",swl:"¬øMejor para SWL?",addNew:"Agregar contacto",email:"Escribir email",ppi:"Reporte PPI",outlook:"Perspectiva",compare:"Comparaci√≥n",industry:"Noticias"}};
let lang="en",currentUser=null,currentTab="ai",buyers=[],chat=[],searchTerm="",filterType="all",editId=null;
function t(k){return T[lang][k]||k}
function setLang(l){lang=l;document.querySelectorAll('.lang-btn').forEach(b=>b.classList.remove('active'));document.querySelectorAll('.lang-btn').forEach(b=>{if((l==='en'&&b.textContent.includes('English'))||(l==='es'&&b.textContent.includes('Espa√±ol')))b.classList.add('active')});document.querySelectorAll('[data-'+l+']').forEach(el=>el.textContent=el.getAttribute('data-'+l));const tog=document.getElementById('langToggle');if(tog)tog.innerHTML=l==='en'?'üá≤üáΩ Espa√±ol':'üá∫üá∏ English';if(currentUser){renderNav();render()}}
function loadData(){const s=localStorage.getItem('fh_buyers');buyers=s?JSON.parse(s):[...defaultBuyers]}
function saveData(){localStorage.setItem('fh_buyers',JSON.stringify(buyers))}
function handleLogin(){const u=document.getElementById('username').value,p=document.getElementById('password').value,user=users.find(x=>x.username===u&&x.password===p);if(user){currentUser=user;document.getElementById('loginScreen').classList.add('hidden');document.getElementById('app').classList.add('active');document.getElementById('userBadge').textContent=(user.role==='admin'?'üëë ':'üë§ ')+user.name;loadData();initApp()}else{document.getElementById('loginError').classList.add('show')}}
function quickLogin(){currentUser=users[1];document.getElementById('loginScreen').classList.add('hidden');document.getElementById('app').classList.add('active');document.getElementById('userBadge').textContent='üëë Robert Vandling';loadData();initApp()}
function logout(){currentUser=null;chat=[];document.getElementById('app').classList.remove('active');document.getElementById('loginScreen').classList.remove('hidden');document.getElementById('username').value='';document.getElementById('password').value='';document.getElementById('loginError').classList.remove('show')}
function initApp(){renderTicker();if(chat.length===0){chat.push({role:'ai',content:lang==='es'?'üëã ¬°Hola! Soy tu asistente IA.<br><br>Preg√∫ntame sobre:<br>‚Ä¢ Precios - "¬øQui√©n paga m√°s por OCC?"<br>‚Ä¢ Contactos - "Info de Georgia Pacific"<br>‚Ä¢ Agregar - "Agregar comprador"<br>‚Ä¢ Emails - "Escribir email"':'üëã Hi! I\'m your AI assistant.<br><br>Ask me about:<br>‚Ä¢ Prices - "Who pays most for OCC?"<br>‚Ä¢ Buyers - "Tell me about Georgia Pacific"<br>‚Ä¢ Add - "Add new buyer"<br>‚Ä¢ Emails - "Draft email"'})}renderNav();render()}
function renderTicker(){const items=[...tickerItems,...tickerItems,...tickerItems];document.getElementById('ticker').innerHTML=items.map(i=>'<div class="ticker-item"><span class="ticker-tag '+i.type+'">'+i.type.toUpperCase()+'</span>'+i.text+'</div>').join('')}
function renderNav(){const tabs=[{id:'ai',icon:'ü§ñ',label:t('ai'),ai:true},{id:'dashboard',icon:'üìä',label:t('dash')},{id:'contacts',icon:'üë•',label:t('contacts'),count:buyers.length},{id:'prices',icon:'üí∞',label:t('prices')},{id:'news',icon:'üì∞',label:t('news')}];document.getElementById('nav').innerHTML=tabs.map(x=>'<button class="nav-btn '+(currentTab===x.id?'active':'')+(x.ai&&currentTab!==x.id?' ai':'')+'" onclick="setTab(\''+x.id+'\')">'+x.icon+' '+x.label+(x.count!==undefined?' <span style="background:rgba(255,255,255,0.3);padding:2px 6px;border-radius:4px;font-size:10px">'+x.count+'</span>':'')+'</button>').join('')}
function setTab(tab){currentTab=tab;renderNav();render()}
function render(){const m=document.getElementById('main');if(currentTab==='ai')m.innerHTML=renderAI();else if(currentTab==='dashboard')m.innerHTML=renderDash();else if(currentTab==='contacts')m.innerHTML=renderContacts();else if(currentTab==='prices')m.innerHTML=renderPrices();else if(currentTab==='news')m.innerHTML=renderNews()}
function renderAI(){const bO=buyers.filter(b=>b.prices?.OCC).sort((a,b)=>b.prices.OCC-a.prices.OCC)[0],bS=buyers.filter(b=>b.prices?.SWL).sort((a,b)=>b.prices.SWL-a.prices.SWL)[0],bP=buyers.filter(b=>b.prices?.PM).sort((a,b)=>b.prices.PM-a.prices.PM)[0];return '<div class="ai-container"><div class="chat-panel"><div class="chat-header"><div class="chat-avatar">ü§ñ</div><div><div class="chat-title">Fiber Hub AI</div><div class="chat-status">Powered by Claude</div></div></div><div class="chat-messages" id="chatBox">'+chat.map(m=>'<div class="msg '+m.role+'"><div class="msg-avatar">'+(m.role==='ai'?'ü§ñ':'üë§')+'</div><div class="msg-content">'+m.content+'</div></div>').join('')+'</div><div class="chat-input-area"><input type="text" class="chat-input" id="chatInput" placeholder="'+(lang==='es'?'Pregunta algo...':'Ask anything...')+'" onkeypress="if(event.key===\'Enter\')sendChat()"><button class="btn btn-purple" onclick="sendChat()">'+(lang==='es'?'Enviar':'Send')+'</button></div></div><div class="sidebar"><div class="sidebar-card"><div class="sidebar-title">‚ö° '+t('quick')+'</div><button class="quick-btn" onclick="ask(\''+t('who')+'\')">üì¶ '+t('who')+'</button><button class="quick-btn" onclick="ask(\''+t('swl')+'\')">üìÑ '+t('swl')+'</button><button class="quick-btn" onclick="openModal()">‚ûï '+t('addNew')+'</button><button class="quick-btn" onclick="ask(\''+t('email')+'\')">‚úâÔ∏è '+t('email')+'</button><button class="quick-btn" onclick="ask(\''+t('ppi')+'\')">üìä '+t('ppi')+'</button><button class="quick-btn" onclick="ask(\''+t('outlook')+'\')">üìà '+t('outlook')+'</button></div><div class="sidebar-card"><div class="sidebar-title">üéØ '+t('best')+'</div>'+(bO?'<div class="rec-card"><div class="rec-label">'+t('bestOCC')+'</div><div class="rec-value">$'+bO.prices.OCC+'/ton</div><div class="rec-detail">'+bO.company+'</div></div>':'')+(bS?'<div class="rec-card"><div class="rec-label">'+t('bestSWL')+'</div><div class="rec-value">$'+bS.prices.SWL+'/ton</div><div class="rec-detail">'+bS.company+'</div></div>':'')+(bP?'<div class="rec-card"><div class="rec-label">'+t('bestPM')+'</div><div class="rec-value">$'+bP.prices.PM+'/ton</div><div class="rec-detail">'+bP.company+'</div></div>':'')+'</div></div></div>'}
function ask(q){document.getElementById('chatInput').value=q;sendChat()}
function sendChat(){const inp=document.getElementById('chatInput'),msg=inp.value.trim();if(!msg)return;chat.push({role:'user',content:msg});inp.value='';chat.push({role:'ai',content:aiResp(msg)});render();setTimeout(()=>{const b=document.getElementById('chatBox');if(b)b.scrollTop=b.scrollHeight},100)}
function aiResp(msg){const m=msg.toLowerCase(),es=lang==='es';if(m.includes('add')||m.includes('agregar')||m.includes('new')||m.includes('nuevo')){setTimeout(()=>openModal(),500);return es?'Abriendo formulario...':'Opening form...';}if(m.includes('ppi')||m.includes('report')||m.includes('reporte')){return '<b>üìä '+(es?'Reporte PPI':'PPI Report')+'</b><br><br>'+marketPrices.map(p=>'<b>'+p.code+':</b> $'+p.price+' ('+(p.change>0?'‚ñ≤':'‚ñº')+'$'+Math.abs(p.change)+')').join('<br>');}if(m.includes('occ')&&(m.includes('best')||m.includes('most')||m.includes('mejor')||m.includes('who')||m.includes('qui√©n'))){const s=buyers.filter(b=>b.prices?.OCC).sort((a,b)=>b.prices.OCC-a.prices.OCC);return '<b>üì¶ '+(es?'Mejores OCC':'Best OCC')+':</b><br><br>1. <b>'+s[0].company+'</b> - $'+s[0].prices.OCC+'/ton ‚≠ê<br>'+s[0].contact+' | '+s[0].phone+'<br><br>2. '+s[1]?.company+' - $'+s[1]?.prices.OCC+'/ton';}if(m.includes('swl')||m.includes('white')){const s=buyers.filter(b=>b.prices?.SWL).sort((a,b)=>b.prices.SWL-a.prices.SWL);return '<b>üìÑ '+(es?'Mejores SWL':'Best SWL')+':</b><br><br>1. <b>'+s[0].company+'</b> - $'+s[0].prices.SWL+'/ton ‚≠ê';}if(m.includes('email')||m.includes('draft')||m.includes('escribir')){return es?'<b>‚úâÔ∏è Email:</b><br><br>Asunto: Dalmex - Solicitud de Precios<br><br>Hola,<br><br>Solicito precios actuales para OCC, PM, SWL.<br><br>Gracias,<br>Robert Vandling<br>214-352-2000':'<b>‚úâÔ∏è Email:</b><br><br>Subject: Dalmex - Price Request<br><br>Hello,<br><br>Requesting current prices for OCC, PM, SWL.<br><br>Thanks,<br>Robert Vandling<br>214-352-2000';}if(m.includes('outlook')||m.includes('2026')||m.includes('market')||m.includes('perspectiva')){return es?'<b>üìà Q1 2026:</b><br><br><b style="color:#15803d">ALCISTA</b><br><br>‚úÖ 10% capacidad eliminada<br>‚úÖ Graphic Packaging Waco abre 2026<br>‚úÖ OCC esperado $85-95/ton':'<b>üìà Q1 2026:</b><br><br><b style="color:#15803d">BULLISH</b><br><br>‚úÖ 10% capacity eliminated<br>‚úÖ Graphic Packaging Waco opening 2026<br>‚úÖ OCC expected $85-95/ton';}for(const b of buyers){if(m.includes(b.company.toLowerCase())||m.includes(b.contact.split(' ')[0].toLowerCase())){const pr=b.prices?Object.entries(b.prices).filter(([k,v])=>v).map(([k,v])=>k+': $'+v).join(', '):'N/A';return '<b>üë§ '+b.company+'</b><br><br>Contact: '+b.contact+'<br>Phone: '+b.phone+'<br>Email: '+b.email+'<br>Type: '+b.type+'<br><br>Prices: '+pr+'<br><br>Notes: '+b.notes;}}return es?'Preg√∫ntame sobre precios, compradores, emails...':'Ask about prices, buyers, emails...';}
function renderDash(){const mills=buyers.filter(b=>b.type==='Mill').length,pri=buyers.filter(b=>b.priority).length,bO=buyers.filter(b=>b.prices?.OCC).sort((a,b)=>b.prices.OCC-a.prices.OCC)[0];return '<div class="grid grid-2" style="margin-bottom:20px"><div class="card stat-card"><div class="stat-icon">üè≠</div><div class="stat-value">'+mills+'</div><div class="stat-label">'+(lang==='es'?'Molinos':'Mills')+'</div></div><div class="card stat-card"><div class="stat-icon">üë•</div><div class="stat-value">'+buyers.length+'</div><div class="stat-label">'+(lang==='es'?'Contactos':'Contacts')+'</div></div><div class="card stat-card"><div class="stat-icon">‚≠ê</div><div class="stat-value">'+pri+'</div><div class="stat-label">'+(lang==='es'?'Prioritarios':'Priority')+'</div></div><div class="card stat-card"><div class="stat-icon">üí∞</div><div class="stat-value">$'+(bO?.prices.OCC||'--')+'</div><div class="stat-label">'+(lang==='es'?'Mejor OCC':'Best OCC')+'</div></div></div><div class="market-grid">'+marketPrices.slice(0,4).map(p=>'<div class="market-card"><div class="market-code">'+p.code+'</div><div class="market-price">'+p.range+'</div><div class="market-change '+(p.change>0?'up':'down')+'">'+(p.change>0?'‚ñ≤':'‚ñº')+'$'+Math.abs(p.change)+'</div></div>').join('')+'</div><div class="section-header"><h3 class="section-title">‚≠ê '+(lang==='es'?'Prioritarios':'Priority')+'</h3></div><div class="grid grid-3">'+buyers.filter(b=>b.priority).slice(0,6).map(b=>renderCard(b)).join('')+'</div>';}
function renderContacts(){let f=buyers;if(searchTerm)f=f.filter(b=>b.company.toLowerCase().includes(searchTerm.toLowerCase())||b.contact.toLowerCase().includes(searchTerm.toLowerCase()));if(filterType!=='all')f=f.filter(b=>b.type===filterType);return '<div class="section-header"><h3 class="section-title">üë• '+t('contacts')+' ('+buyers.length+')</h3><button class="btn btn-green" onclick="openModal()">‚ûï '+t('add')+'</button></div><div class="search-bar"><input type="text" class="search-input" placeholder="üîç '+t('search')+'" value="'+searchTerm+'" oninput="searchTerm=this.value;render()"><button class="filter-btn '+(filterType==='all'?'active':'')+'" onclick="filterType=\'all\';render()">'+t('all')+'</button><button class="filter-btn '+(filterType==='Mill'?'active':'')+'" onclick="filterType=\'Mill\';render()">'+t('mills')+'</button><button class="filter-btn '+(filterType==='Broker'?'active':'')+'" onclick="filterType=\'Broker\';render()">'+t('brokers')+'</button></div><div class="grid grid-3">'+f.map(b=>renderCard(b)).join('')+'</div>';}
function renderCard(b){const init=b.company.split(' ').map(w=>w[0]).join('').slice(0,2),badge=b.type==='Mill'?'badge-mill':b.type==='Export'?'badge-export':'badge-broker',pr=b.prices?Object.entries(b.prices).filter(([k,v])=>v):[];return '<div class="card '+(b.priority?'priority':'')+'"><div class="card-header"><div class="avatar">'+init+'</div><div class="badges"><span class="badge '+badge+'">'+b.type+'</span>'+(b.priority?'<span class="badge badge-priority">‚≠ê</span>':'')+'</div></div><div class="card-title">'+b.company+'</div><div class="card-subtitle">'+b.contact+'</div><div class="card-info">üìß '+b.email+'<br>üìû '+b.phone+'</div><div class="tags">'+(b.commodities||[]).slice(0,4).map(c=>'<span class="tag">'+c+'</span>').join('')+'</div>'+(pr.length?'<div class="prices">'+pr.slice(0,4).map(([k,v])=>'<span class="price">'+k+': $'+v+'</span>').join('')+'</div>':'')+'<div class="card-actions"><button class="btn btn-green" onclick="window.open(\'mailto:'+b.email+'\')">üìß</button><button class="btn btn-gray" onclick="window.open(\'tel:'+b.phone+'\')">üìû</button><button class="btn btn-purple" onclick="editContact('+b.id+')">‚úèÔ∏è</button><button class="btn btn-danger" onclick="deleteContact('+b.id+')">üóëÔ∏è</button></div></div>';}
function renderPrices(){const gr=['OCC','PM','SWL','DLK','SOP','HWEC'],mx={};gr.forEach(g=>{const ps=buyers.map(b=>b.prices?.[g]).filter(p=>p);mx[g]=ps.length?Math.max(...ps):0});return '<div class="section-header"><h3 class="section-title">üí∞ '+t('compare')+'</h3></div><div class="market-grid">'+marketPrices.map(p=>'<div class="market-card"><div class="market-code">'+p.code+'</div><div class="market-price">'+p.range+'</div><div class="market-change '+(p.change>0?'up':'down')+'">'+(p.change>0?'‚ñ≤':'‚ñº')+'$'+Math.abs(p.change)+'</div></div>').join('')+'</div><div class="table-wrap"><div class="table-header">üìä '+(lang==='es'?'Comparaci√≥n de Precios':'Price Comparison')+'</div><div class="table-scroll"><table><thead><tr><th>'+(lang==='es'?'Comprador':'Buyer')+'</th>'+gr.map(g=>'<th>'+g+'</th>').join('')+'<th>'+(lang==='es'?'Tipo':'Type')+'</th></tr></thead><tbody>'+buyers.filter(b=>b.prices).sort((a,b)=>(b.prices.OCC||0)-(a.prices.OCC||0)).map(b=>'<tr><td><b>'+b.company+'</b><br><small style="color:#64748b">'+b.contact+'</small></td>'+gr.map(g=>{const p=b.prices[g];if(!p)return'<td style="color:#cbd5e1">‚Äî</td>';return'<td><span class="'+(p===mx[g]?'price-best':'')+'">'+(p===mx[g]?'‚≠ê ':'')+'$'+p+'</span></td>'}).join('')+'<td><span class="badge badge-'+b.type.toLowerCase()+'">'+b.type+'</span></td></tr>').join('')+'</tbody></table></div></div>';}
function renderNews(){return '<div class="section-header"><h3 class="section-title">üì∞ '+t('industry')+'</h3></div>'+news.map(n=>'<div class="news-item"><div class="news-date">'+n.date+'</div><div class="news-title">'+(lang==='es'?n.titleEs:n.title)+'</div><div class="news-excerpt">'+(lang==='es'?n.excerptEs:n.excerpt)+'</div></div>').join('');}
function openModal(){editId=null;document.getElementById('contactForm').reset();document.getElementById('addModal').classList.add('active')}
function closeModal(){document.getElementById('addModal').classList.remove('active')}
function editContact(id){const b=buyers.find(x=>x.id===id);if(!b)return;editId=id;document.getElementById('fCompany').value=b.company;document.getElementById('fContact').value=b.contact;document.getElementById('fEmail').value=b.email;document.getElementById('fPhone').value=b.phone||'';document.getElementById('fType').value=b.type;document.getElementById('fPriority').checked=b.priority;document.getElementById('fNotes').value=b.notes||'';document.querySelectorAll('input[name="comm"]').forEach(cb=>cb.checked=(b.commodities||[]).includes(cb.value));document.getElementById('addModal').classList.add('active')}
function deleteContact(id){if(confirm(lang==='es'?'¬øEliminar?':'Delete?')){buyers=buyers.filter(b=>b.id!==id);saveData();renderNav();render();toast(lang==='es'?'Eliminado':'Deleted')}}
document.getElementById('contactForm').addEventListener('submit',function(e){e.preventDefault();const comms=[];document.querySelectorAll('input[name="comm"]:checked').forEach(cb=>comms.push(cb.value));const data={company:document.getElementById('fCompany').value,contact:document.getElementById('fContact').value,email:document.getElementById('fEmail').value,phone:document.getElementById('fPhone').value,type:document.getElementById('fType').value,priority:document.getElementById('fPriority').checked,commodities:comms,notes:document.getElementById('fNotes').value,prices:{}};if(editId){const idx=buyers.findIndex(b=>b.id===editId);if(idx!==-1)buyers[idx]={...buyers[idx],...data};toast(lang==='es'?'Actualizado':'Updated')}else{data.id=buyers.length?Math.max(...buyers.map(b=>b.id))+1:1;buyers.push(data);toast(lang==='es'?'Agregado':'Added')}saveData();closeModal();renderNav();render()});
function toast(msg){const t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),3000)}
document.addEventListener('keypress',e=>{if(e.key==='Enter'&&!currentUser)handleLogin()});
</script>
</body>
</html>
