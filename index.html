<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<title>Dalmex Fiber Hub - Lead Generation</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root{--primary:#6366f1;--primary-dark:#4f46e5;--success:#10b981;--warning:#f59e0b;--danger:#ef4444;--ai-purple:#8b5cf6;--ai-purple-dark:#7c3aed;--dark:#1e293b;--darker:#0f172a;--card-bg:#fff;--bg:#f1f5f9;--light:#e2e8f0;--text:#1e293b;--text-muted:#64748b;--header-bg:#fff;--table-header:#f1f5f9;--border:#e2e8f0;--profit:#10b981;--loss:#ef4444}
.theme-terminal{--primary:#22d3ee;--primary-dark:#0891b2;--success:#22c55e;--warning:#eab308;--danger:#ef4444;--ai-purple:#a855f7;--ai-purple-dark:#7c3aed;--dark:#0a0a0a;--darker:#000;--card-bg:#111;--bg:#0a0a0a;--light:#222;--text:#e4e4e7;--text-muted:#a1a1aa;--header-bg:#111;--table-header:#1a1a1a;--border:#333;--profit:#22c55e;--loss:#ef4444}
.theme-terminal body{background:#0a0a0a}.theme-terminal .ticker-wrap{background:linear-gradient(90deg,#000,#111)}.theme-terminal .header{background:#111;border-color:#333}.theme-terminal .nav-bar{background:#111;border-color:#333}.theme-terminal .panel-card,.theme-terminal .stat-card,.theme-terminal .contact-card,.theme-terminal .lead-card,.theme-terminal .resource-card{background:#111;border:1px solid #333}.theme-terminal .data-table th{background:#1a1a1a}.theme-terminal .data-table td{border-color:#333}.theme-terminal .form-input,.theme-terminal .form-select,.theme-terminal .form-textarea{background:#1a1a1a;border-color:#333;color:#e4e4e7}.theme-terminal .search-box{background:#111}.theme-terminal .filter-btn{background:#111;border-color:#333;color:#a1a1aa}.theme-terminal .filter-btn.active{background:#22d3ee;border-color:#22d3ee;color:#000}.theme-terminal .footer{border-color:#333}.theme-terminal .brand-title{background:linear-gradient(135deg,#22d3ee,#a855f7);-webkit-background-clip:text}
.theme-corporate{--primary:#1e3a5f;--primary-dark:#0f2744;--success:#059669;--warning:#d97706;--danger:#dc2626;--ai-purple:#1e3a5f;--ai-purple-dark:#0f2744;--dark:#1e3a5f;--darker:#0f2744;--card-bg:#fff;--bg:#f8fafc;--light:#e2e8f0;--text:#1e293b;--text-muted:#64748b;--header-bg:#1e3a5f;--table-header:#f1f5f9;--border:#cbd5e1;--profit:#059669;--loss:#dc2626}.theme-corporate .header{background:#1e3a5f}.theme-corporate .brand-title{color:#fff;-webkit-text-fill-color:#fff}.theme-corporate .brand-sub{color:rgba(255,255,255,.7)}.theme-corporate .user-badge{background:rgba(255,255,255,.2);color:#fff}.theme-corporate .admin-login-btn{background:#fff;color:#1e3a5f}.theme-corporate .ticker-wrap{background:#0f2744}.theme-corporate .nav-btn{background:#e2e8f0}.theme-corporate .nav-btn.active{background:#1e3a5f}.theme-corporate .logo{background:#fff}
*{margin:0;padding:0;box-sizing:border-box}body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;transition:all .3s}
.ticker-wrap{background:linear-gradient(90deg,var(--darker),var(--dark));padding:8px 0;overflow:hidden}.ticker{display:flex;animation:tickerScroll 45s linear infinite;width:max-content}@keyframes tickerScroll{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}.ticker-item{display:inline-flex;align-items:center;gap:6px;margin-right:40px;color:#f1f5f9;font-size:12px;white-space:nowrap}.ticker-badge{padding:2px 6px;border-radius:4px;font-size:9px;font-weight:700;text-transform:uppercase}.ticker-badge.price{background:var(--warning);color:#000}.ticker-badge.tip{background:#3b82f6}.ticker-badge.alert{background:var(--danger)}
.header{background:var(--header-bg);padding:10px 16px;border-bottom:1px solid var(--border);position:sticky;top:0;z-index:100}.header-inner{max-width:1400px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px}.header-left{display:flex;align-items:center;gap:10px}.logo{width:40px;height:40px;background:linear-gradient(135deg,var(--ai-purple),var(--ai-purple-dark));border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px}.brand-title{font-size:18px;font-weight:800;background:linear-gradient(135deg,var(--ai-purple),var(--primary));-webkit-background-clip:text;-webkit-text-fill-color:transparent}.brand-sub{font-size:10px;color:var(--text-muted)}.header-right{display:flex;align-items:center;gap:8px}.user-badge{background:var(--light);padding:5px 10px;border-radius:6px;font-size:11px;font-weight:600;color:var(--text)}.user-badge.admin{background:linear-gradient(135deg,var(--warning),#d97706);color:#fff}.admin-login-btn{padding:6px 10px;border:none;border-radius:6px;font-size:11px;font-weight:600;cursor:pointer;background:linear-gradient(135deg,var(--warning),#d97706);color:#fff}
.theme-selector{display:flex;gap:4px}.theme-btn{width:24px;height:24px;border-radius:5px;border:2px solid var(--border);cursor:pointer;transition:all .2s}.theme-btn:hover{transform:scale(1.1)}.theme-btn.active{border-color:var(--primary);box-shadow:0 0 0 2px var(--primary)}.theme-btn.t-default{background:linear-gradient(135deg,#8b5cf6,#6366f1)}.theme-btn.t-terminal{background:linear-gradient(135deg,#000,#22c55e)}.theme-btn.t-corporate{background:linear-gradient(135deg,#1e3a5f,#fff)}
.nav-bar{background:var(--card-bg);padding:8px 16px;border-bottom:1px solid var(--border);overflow-x:auto}.nav-inner{max-width:1400px;margin:0 auto;display:flex;gap:6px}.nav-btn{padding:8px 14px;border:none;background:var(--light);border-radius:8px;font-size:12px;font-weight:600;color:var(--text-muted);cursor:pointer;display:flex;align-items:center;gap:5px;white-space:nowrap}.nav-btn:hover{background:#e0e7ff;color:var(--primary)}.nav-btn.active{background:linear-gradient(135deg,var(--primary),var(--ai-purple));color:#fff}.nav-btn.admin-only{background:linear-gradient(135deg,var(--warning),#d97706);color:#fff}.nav-btn.leads{background:linear-gradient(135deg,#dc2626,#ef4444);color:#fff}.nav-btn.resources{background:linear-gradient(135deg,#059669,#10b981);color:#fff}.nav-count{background:rgba(255,255,255,.3);padding:2px 6px;border-radius:5px;font-size:10px}
.main{max-width:1400px;margin:0 auto;padding:16px}
.login-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;z-index:1000;padding:16px}.login-overlay.active{display:flex}.login-card{background:var(--card-bg);border-radius:20px;padding:32px;width:100%;max-width:360px}.login-logo{width:60px;height:60px;background:linear-gradient(135deg,var(--warning),#d97706);border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:30px;margin:0 auto 16px}.login-title{text-align:center;font-size:20px;font-weight:800;margin-bottom:6px;color:var(--text)}.login-subtitle{text-align:center;color:var(--text-muted);margin-bottom:20px;font-size:12px}.login-error{background:#fef2f2;color:var(--danger);padding:10px;border-radius:8px;margin-bottom:12px;font-size:12px;text-align:center;display:none}.login-error.show{display:block}.form-group{margin-bottom:14px}.form-label{display:block;margin-bottom:5px;font-weight:600;font-size:12px;color:var(--text-muted)}.form-input,.form-textarea{width:100%;padding:12px 14px;border:2px solid var(--border);border-radius:10px;font-size:14px;font-family:inherit;background:var(--card-bg);color:var(--text)}.form-input:focus,.form-textarea:focus{outline:none;border-color:var(--primary)}.form-textarea{min-height:80px;resize:vertical}.login-btn{width:100%;padding:14px;background:linear-gradient(135deg,var(--warning),#d97706);color:#fff;border:none;border-radius:10px;font-size:14px;font-weight:700;cursor:pointer;margin-top:8px}.login-cancel{width:100%;padding:10px;background:var(--light);color:var(--text);border:none;border-radius:10px;font-size:13px;font-weight:600;cursor:pointer;margin-top:8px}
.panel-card{background:var(--card-bg);border-radius:14px;padding:16px;box-shadow:0 4px 15px rgba(0,0,0,.06);margin-bottom:16px}.panel-title{font-size:12px;font-weight:700;color:var(--text-muted);margin-bottom:12px;text-transform:uppercase;display:flex;justify-content:space-between;align-items:center}
.btn{padding:10px 16px;border:none;border-radius:8px;font-size:12px;font-weight:600;cursor:pointer;display:inline-flex;align-items:center;gap:6px;text-decoration:none}.btn-primary{background:var(--primary);color:#fff}.btn-success{background:var(--success);color:#fff}.btn-warning{background:var(--warning);color:#fff}.btn-danger{background:var(--danger);color:#fff}.btn-outline{background:transparent;border:2px solid var(--border);color:var(--text)}.btn-sm{padding:6px 12px;font-size:11px}.btn-purple{background:linear-gradient(135deg,var(--ai-purple),var(--ai-purple-dark));color:#fff}.btn:hover{opacity:0.9}
.lead-stats{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:16px}.lead-stat{background:var(--card-bg);border-radius:10px;padding:12px;text-align:center}.lead-stat-value{font-size:22px;font-weight:800}.lead-stat-label{font-size:9px;color:var(--text-muted);text-transform:uppercase}.lead-stat.new .lead-stat-value{color:var(--primary)}.lead-stat.contacted .lead-stat-value{color:var(--warning)}.lead-stat.responded .lead-stat-value{color:var(--success)}.lead-stat.converted .lead-stat-value{color:#06b6d4}
.lead-card{background:var(--card-bg);border-radius:12px;padding:14px;margin-bottom:10px;border-left:4px solid var(--border)}.lead-card.new{border-left-color:var(--primary)}.lead-card.contacted{border-left-color:var(--warning)}.lead-card.responded{border-left-color:var(--success)}.lead-card.converted{border-left-color:#22d3ee}.lead-header{display:flex;justify-content:space-between;align-items:start;margin-bottom:8px}.lead-company{font-size:14px;font-weight:700;color:var(--text)}.lead-status{padding:3px 8px;border-radius:5px;font-size:9px;font-weight:600;text-transform:uppercase}.lead-status.new{background:#e0e7ff;color:#4338ca}.lead-status.contacted{background:#fef3c7;color:#b45309}.lead-status.responded{background:#d1fae5;color:#047857}.lead-status.converted{background:#cffafe;color:#0891b2}.lead-details{font-size:11px;color:var(--text-muted);margin-bottom:8px}.lead-details div{margin-bottom:3px}.lead-materials{display:flex;flex-wrap:wrap;gap:4px;margin-bottom:10px}.lead-material{background:var(--bg);padding:2px 6px;border-radius:4px;font-size:9px;font-weight:600;color:var(--text)}.lead-actions{display:flex;gap:6px;flex-wrap:wrap}.lead-action{padding:6px 10px;border:none;border-radius:6px;font-size:10px;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:4px;text-decoration:none}.lead-action.email{background:#dbeafe;color:#1d4ed8}.lead-action.sms{background:#d1fae5;color:#047857}.lead-action.call{background:#fef3c7;color:#b45309}.lead-action.convert{background:linear-gradient(135deg,var(--success),#059669);color:#fff}.lead-action.delete{background:#fee2e2;color:#dc2626}.lead-action:hover{opacity:0.8}
.resource-card{background:var(--card-bg);border-radius:12px;padding:16px;margin-bottom:12px;border:2px solid var(--border)}.resource-card:hover{border-color:var(--primary)}.resource-header{display:flex;align-items:center;gap:12px;margin-bottom:10px}.resource-icon{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:22px}.resource-title{font-size:14px;font-weight:700;color:var(--text)}.resource-type{font-size:10px;color:var(--text-muted)}.resource-desc{font-size:11px;color:var(--text-muted);line-height:1.5;margin-bottom:12px}.resource-tips{background:var(--bg);border-radius:8px;padding:10px;margin-bottom:12px}.resource-tips-title{font-size:10px;font-weight:700;color:var(--text);margin-bottom:6px}.resource-tips ul{font-size:10px;color:var(--text-muted);margin-left:16px;line-height:1.6}.resource-link{display:inline-flex;align-items:center;gap:6px;padding:8px 14px;background:var(--primary);color:#fff;border-radius:6px;font-size:11px;font-weight:600;text-decoration:none}.resource-link:hover{opacity:0.9}
.company-list{background:var(--bg);border-radius:10px;padding:12px;margin-bottom:12px}.company-list-title{font-size:11px;font-weight:700;color:var(--text);margin-bottom:8px}.company-item{display:flex;justify-content:space-between;align-items:center;padding:8px;background:var(--card-bg);border-radius:6px;margin-bottom:6px}.company-item:last-child{margin-bottom:0}.company-name{font-size:12px;font-weight:600;color:var(--text)}.company-type{font-size:9px;color:var(--text-muted)}.company-actions{display:flex;gap:4px}.company-action{padding:4px 8px;border-radius:4px;font-size:9px;font-weight:600;text-decoration:none;background:var(--light);color:var(--text)}.company-action:hover{background:var(--primary);color:#fff}
.contacts-header{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px;margin-bottom:12px}.search-box{display:flex;align-items:center;gap:6px;background:var(--card-bg);padding:7px 10px;border-radius:8px;flex:1;max-width:260px;border:1px solid var(--border)}.search-box input{border:none;background:none;flex:1;font-size:12px;font-family:inherit;color:var(--text)}.search-box input:focus{outline:none}.filter-btns{display:flex;gap:4px;flex-wrap:wrap}.filter-btn{padding:5px 10px;border:2px solid var(--border);background:var(--card-bg);border-radius:6px;font-size:10px;font-weight:600;cursor:pointer;color:var(--text-muted)}.filter-btn.active{border-color:var(--primary);background:#e0e7ff;color:var(--primary)}
.contact-card{background:var(--card-bg);border-radius:12px;padding:12px;border:2px solid transparent;margin-bottom:10px}.contact-card.priority{border-color:var(--warning)}.contact-header{display:flex;justify-content:space-between;align-items:start;margin-bottom:6px}.contact-name{font-size:13px;font-weight:700;color:var(--text)}.contact-type{display:inline-block;padding:2px 6px;border-radius:4px;font-size:9px;font-weight:600;text-transform:uppercase}.contact-type.mill{background:#dbeafe;color:#1d4ed8}.contact-type.broker{background:#fef3c7;color:#b45309}.contact-type.export{background:#d1fae5;color:#047857}.contact-person{font-size:10px;color:var(--text-muted);margin-bottom:4px}.contact-email{font-size:9px;color:var(--primary);margin-bottom:6px}.contact-prices{display:grid;grid-template-columns:repeat(auto-fit,minmax(40px,1fr));gap:4px;margin-bottom:8px;padding:8px;background:var(--bg);border-radius:8px}.price-item{text-align:center}.price-label{font-size:8px;color:var(--text-muted);text-transform:uppercase}.price-value{font-size:11px;font-weight:700;color:var(--profit)}.contact-actions{display:flex;gap:4px}.contact-action{padding:6px 8px;background:var(--bg);border:none;border-radius:5px;font-size:10px;font-weight:600;cursor:pointer;color:var(--text);text-decoration:none}.contact-action:hover{background:var(--light)}.contact-action.call{background:#d1fae5;color:#047857}.contact-action.email{background:#dbeafe;color:#1d4ed8}
.outreach-template{background:linear-gradient(135deg,#eff6ff,#dbeafe);border:2px solid var(--primary);border-radius:12px;padding:14px;margin-bottom:16px}.outreach-title{font-size:13px;font-weight:700;color:#1e40af;margin-bottom:8px}.outreach-text{font-size:11px;line-height:1.6;color:#1e3a5f;background:#fff;padding:12px;border-radius:8px;margin-bottom:10px;white-space:pre-wrap}
.share-section{background:linear-gradient(135deg,#dbeafe,#bfdbfe);border:2px solid var(--primary);border-radius:12px;padding:14px;margin-bottom:14px}.share-title{font-size:13px;font-weight:700;color:#1e40af;margin-bottom:6px}.share-url{background:#fff;padding:8px;border-radius:6px;font-size:10px;word-break:break-all;margin:8px 0;border:1px solid var(--primary);color:var(--text)}.share-btns{display:flex;gap:6px;flex-wrap:wrap}
.qr-section{background:linear-gradient(135deg,#f0fdf4,#dcfce7);border:2px solid var(--success);border-radius:12px;padding:14px;margin-bottom:14px;text-align:center}.qr-title{font-size:13px;font-weight:700;color:#166534;margin-bottom:10px}.qr-code{background:#fff;padding:10px;border-radius:8px;display:inline-block}
.empty-state{text-align:center;padding:40px 20px;color:var(--text-muted)}.empty-icon{font-size:48px;margin-bottom:12px}.empty-title{font-size:16px;font-weight:700;color:var(--text);margin-bottom:6px}.empty-desc{font-size:12px;margin-bottom:16px}
.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:1000;padding:16px}.modal-overlay.active{display:flex}.modal{background:var(--card-bg);border-radius:16px;width:100%;max-width:480px;max-height:90vh;overflow-y:auto}.modal-header{padding:14px 16px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}.modal-title{font-size:15px;font-weight:700;color:var(--text)}.modal-close{width:28px;height:28px;border-radius:7px;border:none;background:var(--light);cursor:pointer;font-size:14px;display:flex;align-items:center;justify-content:center;color:var(--text)}.modal-body{padding:16px}.modal-footer{padding:12px 16px;border-top:1px solid var(--border);display:flex;justify-content:flex-end;gap:8px}.form-row{display:grid;grid-template-columns:1fr 1fr;gap:10px}@media(max-width:500px){.form-row{grid-template-columns:1fr}}.form-select{width:100%;padding:10px;border:2px solid var(--border);border-radius:8px;font-size:12px;font-family:inherit;background:var(--card-bg);color:var(--text)}.price-input-group{display:grid;grid-template-columns:repeat(3,1fr);gap:6px}.price-input-item label{display:block;font-size:9px;font-weight:600;color:var(--text-muted);margin-bottom:2px}.price-input-item input{width:100%;padding:8px;border:2px solid var(--border);border-radius:6px;font-size:11px;background:var(--card-bg);color:var(--text)}
.admin-section{background:linear-gradient(135deg,#fef3c7,#fde68a);border:2px solid var(--warning);border-radius:12px;padding:14px;margin-bottom:14px}.admin-section-title{font-size:13px;font-weight:700;color:#92400e;margin-bottom:10px}.admin-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:6px}.admin-btn{padding:10px;background:#fff;border:2px solid var(--warning);border-radius:8px;font-size:10px;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:4px;color:#92400e}.admin-btn:hover{background:var(--warning);color:#fff}
.prices-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(110px,1fr));gap:10px}.price-card{background:var(--card-bg);border-radius:12px;padding:12px}.price-commodity{font-size:11px;font-weight:700;color:var(--text)}.price-current{font-size:18px;font-weight:800;color:var(--profit);margin-bottom:2px}.price-range{font-size:9px;color:var(--text-muted)}
.table-container{overflow-x:auto;background:var(--card-bg);border-radius:12px}.data-table{width:100%;border-collapse:collapse;font-size:11px}.data-table th{background:var(--table-header);padding:8px 6px;text-align:left;font-weight:600;font-size:9px;text-transform:uppercase;color:var(--text-muted)}.data-table td{padding:8px 6px;border-bottom:1px solid var(--border);color:var(--text)}.data-table tr:hover{background:var(--bg)}
.toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%) translateY(100px);background:var(--dark);color:#fff;padding:10px 18px;border-radius:8px;font-size:12px;font-weight:500;z-index:2000;opacity:0;transition:all .3s}.toast.show{transform:translateX(-50%) translateY(0);opacity:1}
.footer{text-align:center;padding:16px;color:var(--text-muted);font-size:9px;border-top:1px solid var(--border);margin-top:20px}
@media(max-width:768px){.header-inner{flex-direction:column;gap:8px}.lead-stats{grid-template-columns:repeat(2,1fr)}.form-row{grid-template-columns:1fr}}
</style>
</head>
<body>
<div id="appContainer"></div>
<div class="login-overlay" id="adminLogin">
<div class="login-card">
<div class="login-logo">üëë</div>
<h2 class="login-title">Admin Login</h2>
<p class="login-subtitle">RJVandling only</p>
<div class="login-error" id="loginError"></div>
<div class="form-group"><label class="form-label">Username</label><input type="text" class="form-input" id="username"></div>
<div class="form-group"><label class="form-label">Password</label><input type="password" class="form-input" id="password"></div>
<button class="login-btn" onclick="handleAdminLogin()">üîê Login</button>
<button class="login-cancel" onclick="hideAdminLogin()">Cancel</button>
</div>
</div>
<div class="modal-overlay" id="leadModal">
<div class="modal">
<div class="modal-header"><h3 class="modal-title" id="leadModalTitle">Add Lead</h3><button class="modal-close" onclick="closeLeadModal()">√ó</button></div>
<div class="modal-body">
<div class="form-group"><label class="form-label">Company Name *</label><input type="text" class="form-input" id="lCompany" placeholder="e.g. International Paper"></div>
<div class="form-row"><div class="form-group"><label class="form-label">Contact Name</label><input type="text" class="form-input" id="lContact" placeholder="e.g. John Smith"></div><div class="form-group"><label class="form-label">Title</label><input type="text" class="form-input" id="lTitle" placeholder="e.g. Fiber Buyer"></div></div>
<div class="form-row"><div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" id="lEmail" placeholder="jsmith@company.com"></div><div class="form-group"><label class="form-label">Phone</label><input type="tel" class="form-input" id="lPhone" placeholder="555-123-4567"></div></div>
<div class="form-row"><div class="form-group"><label class="form-label">Type</label><select class="form-select" id="lType"><option value="mill">Mill</option><option value="broker">Broker</option><option value="recycler">Recycler</option><option value="export">Exporter</option></select></div><div class="form-group"><label class="form-label">Region</label><input type="text" class="form-input" id="lRegion" placeholder="TX, Southeast, etc"></div></div>
<div class="form-group"><label class="form-label">Materials They Buy (comma separated)</label><input type="text" class="form-input" id="lMaterials" placeholder="OCC, SWL, PM, CBS, HWEC"></div>
<div class="form-group"><label class="form-label">Notes</label><textarea class="form-textarea" id="lNotes" placeholder="Where you found them, any notes..."></textarea></div>
</div>
<div class="modal-footer"><button class="btn btn-outline" onclick="closeLeadModal()">Cancel</button><button class="btn btn-danger" onclick="saveLead()">üíæ Save Lead</button></div>
</div>
</div>
<div class="modal-overlay" id="buyerModal">
<div class="modal">
<div class="modal-header"><h3 class="modal-title" id="buyerModalTitle">Add Buyer</h3><button class="modal-close" onclick="closeBuyerModal()">√ó</button></div>
<div class="modal-body">
<div class="form-row"><div class="form-group"><label class="form-label">Company *</label><input type="text" class="form-input" id="bCompany"></div><div class="form-group"><label class="form-label">Contact</label><input type="text" class="form-input" id="bContact"></div></div>
<div class="form-row"><div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" id="bEmail"></div><div class="form-group"><label class="form-label">Phone</label><input type="tel" class="form-input" id="bPhone"></div></div>
<div class="form-group"><label class="form-label">Type</label><select class="form-select" id="bType"><option value="mill">Mill</option><option value="broker">Broker</option><option value="export">Export</option></select></div>
<div class="form-group"><label class="form-label">Prices ($/ton)</label><div class="price-input-group"><div class="price-input-item"><label>OCC</label><input type="number" id="pOCC"></div><div class="price-input-item"><label>DLK</label><input type="number" id="pDLK"></div><div class="price-input-item"><label>SWL</label><input type="number" id="pSWL"></div><div class="price-input-item"><label>PM</label><input type="number" id="pPM"></div><div class="price-input-item"><label>CBS</label><input type="number" id="pCBS"></div><div class="price-input-item"><label>HWEC</label><input type="number" id="pHWEC"></div></div></div>
</div>
<div class="modal-footer"><button class="btn btn-outline" onclick="closeBuyerModal()">Cancel</button><button class="btn btn-primary" onclick="saveBuyer()">Save</button></div>
</div>
</div>
<div class="toast" id="toast"></div>
<script>
var adminUser={username:'RJVandling',password:'Sailer66'};
var defaultBuyers=[
{id:1,company:'Georgia Pacific',contact:'Jake Walker',email:'jacob.walker1@gapac.com',phone:'',type:'mill',priority:true,prices:{OCC:65,PM:155,SWL:215,HWEC:370}},
{id:2,company:'SKG Westrock',contact:'Cynthia Torres',email:'cynthia.torres@smurfitwestrock.com',phone:'',type:'mill',priority:true,prices:{OCC:60}},
{id:3,company:'Greenside',contact:'Casandra Espinoza',email:'grupocartonero.mty@gmail.com',phone:'',type:'export',priority:true,prices:{OCC:58,PM:165,SWL:215}},
{id:4,company:'American Fiber',contact:'Steve Minor',email:'sminor@amfiberservices.com',phone:'',type:'broker',priority:true,prices:{SWL:215,CBS:160,HWEC:250}},
{id:5,company:'Marck',contact:'Don Langley',email:'dlongley@marck.net',phone:'',type:'broker',priority:false,prices:{OCC:55,SWL:230}}
];

// REAL companies to research - NO fake contact info
var companiesToResearch=[
{name:'International Paper',type:'Mill',website:'internationalpaper.com',notes:'Largest paper company in US. Multiple TX locations.'},
{name:'Packaging Corp of America',type:'Mill',website:'packagingcorp.com',notes:'Major containerboard producer.'},
{name:'WestRock',type:'Mill',website:'westrock.com',notes:'Now Smurfit WestRock. Large corrugated producer.'},
{name:'Pratt Industries',type:'Mill',website:'prattindustries.com',notes:'100% recycled containerboard. Growing fast.'},
{name:'Clearwater Paper',type:'Mill',website:'clearwaterpaper.com',notes:'Tissue and paperboard.'},
{name:'Graphic Packaging',type:'Mill',website:'graphicpkg.com',notes:'Paperboard packaging.'},
{name:'Sonoco',type:'Mill/Broker',website:'sonoco.com',notes:'Diversified packaging, buys fiber.'},
{name:'Republic Services',type:'Recycler',website:'republicservices.com',notes:'May buy or partner on fiber.'},
{name:'Waste Management',type:'Recycler',website:'wm.com',notes:'Recycling division buys materials.'},
{name:'DS Smith',type:'Mill',website:'dssmith.com',notes:'UK company with US operations.'},
{name:'Cascades',type:'Mill',website:'cascades.com',notes:'Canadian company, US facilities.'},
{name:'Caraustar',type:'Mill',website:'caraustar.com',notes:'Recycled paperboard.'},
{name:'Green Bay Packaging',type:'Mill',website:'gbp.com',notes:'Midwest focus.'},
{name:'Sustana',type:'Mill',website:'sustana.com',notes:'Recycled fiber specialist.'}
];

var resources=[
{id:1,title:'ISRI Member Directory',type:'Industry Association',icon:'üè≠',color:'#3b82f6',url:'https://www.isri.org/recycling-commodities/find-a-recycler',desc:'Institute of Scrap Recycling Industries. Search their member directory for paper recyclers and brokers in your area.',tips:['Search by "Paper" category','Filter by state/region','Look for "Paper Stock Dealers"','Members are verified industry participants']},
{id:2,title:'LinkedIn Sales Navigator',type:'Professional Network',icon:'üíº',color:'#0077b5',url:'https://www.linkedin.com/sales/search/people',desc:'Find procurement managers, fiber buyers, and raw materials purchasers at target companies. Best for finding actual decision-makers.',tips:['Search: "fiber buyer" OR "paper procurement"','Search: "raw materials" + "paper mill"','Filter by location (Texas, Southeast)','Look at who works at your target companies','Send connection requests with personalized notes']},
{id:3,title:'Pulp & Paper Directory (RISI)',type:'Industry Database',icon:'üìã',color:'#059669',url:'https://www.fastmarkets.com/pulp-and-paper',desc:'Comprehensive database of paper mills, converters, and suppliers. Some content requires subscription.',tips:['Search for mills by region','Look for "recovered paper" buyers','Check company profiles for contacts','Trade publications list key players']},
{id:4,title:'AF&PA Member Mills',type:'Industry Association',icon:'üå≤',color:'#166534',url:'https://www.afandpa.org/about-us/member-companies',desc:'American Forest & Paper Association member list. These are the major paper manufacturers in the US.',tips:['All major US paper companies are members','Visit each company website','Look for "Suppliers" or "Vendor" pages','Find procurement/purchasing contacts']},
{id:5,title:'RecyclingMarkets.net',type:'Trading Platform',icon:'‚ôªÔ∏è',color:'#10b981',url:'https://www.recyclingmarkets.net/',desc:'Online marketplace for recyclables. Post listings and connect with buyers. See current market prices.',tips:['Create a seller profile','Post your available materials','Browse buyer listings','Check price benchmarks']},
{id:6,title:'Google Search Strategies',type:'Research Method',icon:'üîç',color:'#ea4335',url:'https://www.google.com',desc:'Use targeted searches to find purchasing contacts and vendor registration pages.',tips:['"fiber procurement manager" + Texas','"paper mill" + "vendor registration"','[Company name] + "suppliers"','[Company name] + "raw materials buyer"','filetype:pdf "recovered paper" supplier']},
{id:7,title:'State Recycling Associations',type:'Regional Networks',icon:'üó∫Ô∏è',color:'#f59e0b',url:'https://www.recyclingassociations.org/',desc:'State-level recycling associations often have member directories and networking events.',tips:['Texas Recycling Association','Regional trade shows','Networking events','Member directories']},
{id:8,title:'Company Career Pages',type:'Research Method',icon:'üëî',color:'#8b5cf6',url:'',desc:'Job postings reveal who buys materials. Search for "Fiber Buyer", "Paper Procurement" positions to find the right departments.',tips:['Indeed: "fiber buyer" jobs','LinkedIn Jobs at target companies','Job descriptions show who to contact','Purchasing department structures']}
];

var tickerItems=[
{type:'tip',text:'Use LinkedIn to find fiber buyers'},
{type:'tip',text:'ISRI directory has verified recyclers'},
{type:'price',text:'OCC: $55-65/ton'},
{type:'alert',text:'Add leads from Resources tab'}
];

var marketPrices={OCC:{low:55,high:65},SWL:{low:215,high:230},PM:{low:155,high:165},CBS:{low:155,high:165},HWEC:{low:250,high:370}};

var isAdmin=false,isBuyerForm=false,currentTab='resources',currentTheme='default',buyers=[],leads=[],searchTerm='',filterType='all',leadFilter='all',editBuyerId=null;

function init(){
var p=new URLSearchParams(window.location.search);
if(p.get('submit')){isBuyerForm=true;renderBuyerForm(p.get('company')||'');}
else{loadData();renderApp();}
}

function loadData(){
var b=localStorage.getItem('fh_buyers11');
buyers=b?JSON.parse(b):JSON.parse(JSON.stringify(defaultBuyers));
var l=localStorage.getItem('fh_leads2');
leads=l?JSON.parse(l):[];
var th=localStorage.getItem('fh_theme');
if(th)currentTheme=th;
}

function saveData(){
localStorage.setItem('fh_buyers11',JSON.stringify(buyers));
localStorage.setItem('fh_leads2',JSON.stringify(leads));
localStorage.setItem('fh_theme',currentTheme);
}

function toast(m){var el=document.getElementById('toast');el.textContent=m;el.classList.add('show');setTimeout(function(){el.classList.remove('show')},2000);}
function setTheme(theme){currentTheme=theme;document.body.className='';if(theme!=='default')document.body.classList.add('theme-'+theme);saveData();}
function getShareLink(){return window.location.origin+window.location.pathname+'?submit=1';}
function getQRUrl(){return 'https://api.qrserver.com/v1/create-qr-code/?size=150x150&data='+encodeURIComponent(getShareLink());}

function renderBuyerForm(company){
document.getElementById('appContainer').innerHTML='<div style="max-width:400px;margin:30px auto;padding:16px"><div class="panel-card" style="padding:24px"><div style="text-align:center;margin-bottom:16px"><div style="width:50px;height:50px;background:linear-gradient(135deg,var(--success),#059669);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:24px;margin:0 auto 12px">üí∞</div><h1 style="font-size:18px;font-weight:800">Submit Your Prices</h1><p style="color:var(--text-muted);font-size:11px">Dalmex Recycling - Dallas, TX</p></div><div id="buyerFormContent"><div class="form-group"><label class="form-label">Company Name *</label><input type="text" class="form-input" id="bfCompany" value="'+company+'"></div><div class="form-group"><label class="form-label">Your Name</label><input type="text" class="form-input" id="bfContact"></div><div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" id="bfEmail"></div><div class="form-group"><label class="form-label">Phone</label><input type="tel" class="form-input" id="bfPhone"></div><div class="form-group"><label class="form-label">Your Buying Prices ($/ton)</label><div class="price-input-group"><div class="price-input-item"><label>OCC</label><input type="number" id="bfOCC" placeholder="55-70"></div><div class="price-input-item"><label>SWL</label><input type="number" id="bfSWL" placeholder="200-240"></div><div class="price-input-item"><label>PM</label><input type="number" id="bfPM" placeholder="145-175"></div><div class="price-input-item"><label>CBS</label><input type="number" id="bfCBS" placeholder="150-180"></div><div class="price-input-item"><label>HWEC</label><input type="number" id="bfHWEC" placeholder="240-380"></div><div class="price-input-item"><label>DLK</label><input type="number" id="bfDLK" placeholder="60-85"></div></div></div><button class="btn btn-success" style="width:100%;padding:14px;font-size:14px" onclick="submitBuyerPrices()">‚úì Submit Prices</button></div></div></div>';
}

function submitBuyerPrices(){
var company=document.getElementById('bfCompany').value.trim();
if(!company){toast('Company name required');return;}
var prices={};
['OCC','SWL','PM','CBS','HWEC','DLK'].forEach(function(c){
var v=document.getElementById('bf'+c).value;
if(v)prices[c]=parseInt(v);
});
var data={company:company,contact:document.getElementById('bfContact').value.trim(),email:document.getElementById('bfEmail').value.trim(),phone:document.getElementById('bfPhone').value.trim(),prices:prices,submitted:new Date().toISOString()};
var pending=JSON.parse(localStorage.getItem('fh_pending')||'[]');
pending.push(data);
localStorage.setItem('fh_pending',JSON.stringify(pending));
document.getElementById('buyerFormContent').innerHTML='<div style="text-align:center;padding:30px;background:#d1fae5;border-radius:12px;color:#047857"><div style="font-size:40px;margin-bottom:12px">‚úÖ</div><h3 style="font-size:16px;margin-bottom:6px">Thank You!</h3><p style="font-size:12px">We\'ll review your pricing and be in touch soon.</p></div>';
}

function renderApp(){
document.getElementById('appContainer').innerHTML='<div class="app"><div class="ticker-wrap"><div class="ticker" id="ticker"></div></div><header class="header"><div class="header-inner"><div class="header-left"><div class="logo">üéØ</div><div><div class="brand-title">Fiber Hub</div><div class="brand-sub">Lead Generation CRM</div></div></div><div class="header-right"><div class="theme-selector"><button class="theme-btn t-default '+(currentTheme==='default'?'active':'')+'" onclick="setTheme(\'default\')"></button><button class="theme-btn t-terminal '+(currentTheme==='terminal'?'active':'')+'" onclick="setTheme(\'terminal\')"></button><button class="theme-btn t-corporate '+(currentTheme==='corporate'?'active':'')+'" onclick="setTheme(\'corporate\')"></button></div><span class="user-badge" id="userBadge">Sales Rep</span><button class="admin-login-btn" id="adminBtn" onclick="showAdminLogin()">üëë</button></div></div></header><nav class="nav-bar"><div class="nav-inner" id="navBar"></div></nav><main class="main" id="main"></main><footer class="footer">¬© 2025 Dalmex Recycling LLC ‚Ä¢ Lead Generation System</footer></div>';
if(currentTheme!=='default')document.body.classList.add('theme-'+currentTheme);
initTicker();renderNav();render();
}

function showAdminLogin(){document.getElementById('adminLogin').classList.add('active');}
function hideAdminLogin(){document.getElementById('adminLogin').classList.remove('active');}
function handleAdminLogin(){
var u=document.getElementById('username').value.trim(),p=document.getElementById('password').value;
if(u.toLowerCase()===adminUser.username.toLowerCase()&&p===adminUser.password){
isAdmin=true;hideAdminLogin();
document.getElementById('userBadge').textContent='üëë Admin';
document.getElementById('userBadge').classList.add('admin');
document.getElementById('adminBtn').style.display='none';
renderNav();render();toast('Welcome!');
}else{document.getElementById('loginError').textContent='Invalid credentials';document.getElementById('loginError').classList.add('show');}
}

function initTicker(){var tk=document.getElementById('ticker'),it=tickerItems.map(function(i){return '<div class="ticker-item"><span class="ticker-badge '+i.type+'">'+i.type.toUpperCase()+'</span> '+i.text+'</div>';}).join('');tk.innerHTML=it+it;}

function renderNav(){
var leadCount=leads.length;
var tabs=[
{id:'resources',icon:'üìö',label:'Find Buyers',resources:true},
{id:'leads',icon:'üéØ',label:'My Leads',count:leadCount,leads:true},
{id:'outreach',icon:'üìß',label:'Outreach'},
{id:'buyers',icon:'üë•',label:'Buyers',count:buyers.length},
{id:'prices',icon:'üí∞',label:'Prices'}
];
if(isAdmin)tabs.push({id:'admin',icon:'‚öôÔ∏è',label:'Admin',adminOnly:true});
document.getElementById('navBar').innerHTML=tabs.map(function(tab){
return '<button class="nav-btn '+(currentTab===tab.id?'active':'')+' '+(tab.adminOnly?'admin-only':'')+(tab.leads?' leads':'')+(tab.resources?' resources':'')+'" onclick="setTab(\''+tab.id+'\')">'+tab.icon+' '+tab.label+(tab.count?' <span class="nav-count">'+tab.count+'</span>':'')+'</button>';
}).join('');
}

function setTab(tab){currentTab=tab;renderNav();render();}
function render(){
var m=document.getElementById('main');
if(currentTab==='resources')m.innerHTML=renderResources();
else if(currentTab==='leads')m.innerHTML=renderLeads();
else if(currentTab==='outreach')m.innerHTML=renderOutreach();
else if(currentTab==='buyers')m.innerHTML=renderBuyers();
else if(currentTab==='prices')m.innerHTML=renderPrices();
else if(currentTab==='admin')m.innerHTML=renderAdmin();
}

function getLeadStats(){var s={new:0,contacted:0,responded:0,converted:0};leads.forEach(function(l){s[l.status]=(s[l.status]||0)+1;});return s;}
function renderResources(){
return '<div style="margin-bottom:14px"><h2 style="font-size:18px;font-weight:800;color:var(--text)">üìö Find Buyers - Research Resources</h2><p style="font-size:11px;color:var(--text-muted)">Use these resources to find REAL contacts at companies that buy recovered fiber</p></div>'+

'<div class="panel-card" style="background:linear-gradient(135deg,#fef3c7,#fde68a);border:2px solid var(--warning)"><div style="display:flex;align-items:start;gap:12px"><div style="font-size:28px">‚ö†Ô∏è</div><div><div style="font-size:13px;font-weight:700;color:#92400e;margin-bottom:4px">How This Works</div><div style="font-size:11px;color:#78350f;line-height:1.6">1. Use the resources below to research real companies and find actual contact info<br>2. Add verified leads to "My Leads" tab with real names, emails, phone numbers<br>3. Use "Outreach" templates to contact them<br>4. When they submit prices, convert them to "Buyers"</div></div></div></div>'+

'<div class="company-list"><div class="company-list-title">üè≠ Target Companies to Research (Real Companies)</div>'+
companiesToResearch.map(function(c){
return '<div class="company-item"><div><div class="company-name">'+c.name+'</div><div class="company-type">'+c.type+' ‚Ä¢ '+c.notes+'</div></div><div class="company-actions"><a href="https://www.google.com/search?q='+encodeURIComponent(c.name+' fiber buyer procurement contact')+'" target="_blank" class="company-action">üîç Search</a><a href="https://www.linkedin.com/search/results/people/?keywords='+encodeURIComponent(c.name+' fiber buyer')+'" target="_blank" class="company-action">üíº LinkedIn</a>'+(c.website?'<a href="https://'+c.website+'" target="_blank" class="company-action">üåê Site</a>':'')+'</div></div>';
}).join('')+'</div>'+

'<div style="display:grid;gap:12px">'+
resources.map(function(r){
return '<div class="resource-card"><div class="resource-header"><div class="resource-icon" style="background:'+r.color+'">'+r.icon+'</div><div><div class="resource-title">'+r.title+'</div><div class="resource-type">'+r.type+'</div></div></div><div class="resource-desc">'+r.desc+'</div><div class="resource-tips"><div class="resource-tips-title">üí° Tips:</div><ul>'+r.tips.map(function(t){return '<li>'+t+'</li>';}).join('')+'</ul></div>'+(r.url?'<a href="'+r.url+'" target="_blank" class="resource-link">üîó Open Resource</a>':'')+'</div>';
}).join('')+'</div>'+

'<div class="panel-card" style="margin-top:16px"><div class="panel-title">‚úÖ When You Find a Contact</div><div style="font-size:11px;color:var(--text-muted);line-height:1.7">Once you find a real person at a company:<br><br>1. Click <strong>üéØ My Leads</strong> tab<br>2. Click <strong>‚ûï Add Lead</strong><br>3. Enter their real info (name, email, phone, company)<br>4. Track your outreach and responses</div><button class="btn btn-danger" style="margin-top:12px" onclick="setTab(\'leads\')">üéØ Go to My Leads</button></div>';
}

function renderLeads(){
var s=getLeadStats();
var filtered=leads.slice();
if(leadFilter!=='all')filtered=filtered.filter(function(l){return l.status===leadFilter;});
if(searchTerm)filtered=filtered.filter(function(l){return l.company.toLowerCase().indexOf(searchTerm.toLowerCase())>-1||(l.contact&&l.contact.toLowerCase().indexOf(searchTerm.toLowerCase())>-1);});

var emptyState='<div class="empty-state"><div class="empty-icon">üéØ</div><div class="empty-title">No Leads Yet</div><div class="empty-desc">Use the "Find Buyers" tab to research contacts, then add them here</div><button class="btn btn-danger" onclick="openLeadModal()">‚ûï Add Your First Lead</button><button class="btn btn-outline" style="margin-left:8px" onclick="setTab(\'resources\')">üìö Find Buyers</button></div>';

return '<div style="margin-bottom:14px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px"><div><h2 style="font-size:18px;font-weight:800;color:var(--text)">üéØ My Leads</h2><p style="font-size:10px;color:var(--text-muted)">Your researched contacts - add real info only</p></div><button class="btn btn-danger btn-sm" onclick="openLeadModal()">‚ûï Add Lead</button></div>'+

'<div class="lead-stats"><div class="lead-stat new"><div class="lead-stat-value">'+s.new+'</div><div class="lead-stat-label">New</div></div><div class="lead-stat contacted"><div class="lead-stat-value">'+s.contacted+'</div><div class="lead-stat-label">Contacted</div></div><div class="lead-stat responded"><div class="lead-stat-value">'+s.responded+'</div><div class="lead-stat-label">Responded</div></div><div class="lead-stat converted"><div class="lead-stat-value">'+s.converted+'</div><div class="lead-stat-label">Converted</div></div></div>'+

(leads.length?'<div class="contacts-header"><div class="search-box"><span>üîç</span><input type="text" placeholder="Search leads..." value="'+searchTerm+'" oninput="searchTerm=this.value;render()"></div><div class="filter-btns"><button class="filter-btn '+(leadFilter==='all'?'active':'')+'" onclick="leadFilter=\'all\';render()">All</button><button class="filter-btn '+(leadFilter==='new'?'active':'')+'" onclick="leadFilter=\'new\';render()">New</button><button class="filter-btn '+(leadFilter==='contacted'?'active':'')+'" onclick="leadFilter=\'contacted\';render()">Contacted</button><button class="filter-btn '+(leadFilter==='responded'?'active':'')+'" onclick="leadFilter=\'responded\';render()">Responded</button></div></div>':'')+

(filtered.length?'<div>'+filtered.map(function(l){
return '<div class="lead-card '+l.status+'"><div class="lead-header"><div class="lead-company">'+l.company+'</div><span class="lead-status '+l.status+'">'+l.status+'</span></div><div class="lead-details"><div>üë§ '+(l.contact||'No contact')+''+(l.title?' - '+l.title:'')+'</div>'+(l.email?'<div>‚úâÔ∏è '+l.email+'</div>':'')+(l.phone?'<div>üìû '+l.phone+'</div>':'')+'<div>üè≠ '+l.type+(l.region?' ‚Ä¢ üìç '+l.region:'')+'</div></div>'+(l.materials&&l.materials.length?'<div class="lead-materials">'+l.materials.map(function(m){return '<span class="lead-material">'+m+'</span>';}).join('')+'</div>':'')+(l.notes?'<div style="font-size:10px;color:var(--text-muted);margin-bottom:8px;font-style:italic">"'+l.notes+'"</div>':'')+'<div class="lead-actions">'+(l.email?'<button class="lead-action email" onclick="emailLead('+l.id+')">‚úâÔ∏è Email</button>':'')+(l.phone?'<button class="lead-action sms" onclick="smsLead('+l.id+')">üí¨ SMS</button><button class="lead-action call" onclick="callLead('+l.id+')">üìû Call</button>':'')+'<button class="lead-action" style="background:var(--bg)" onclick="updateLeadStatus('+l.id+')">üìä Status</button>'+(l.status==='responded'?'<button class="lead-action convert" onclick="convertToBuyer('+l.id+')">‚úì Convert</button>':'')+'<button class="lead-action delete" onclick="deleteLead('+l.id+')">üóëÔ∏è</button></div></div>';
}).join('')+'</div>':emptyState);
}

function renderOutreach(){
var emailTemplate='Subject: Price Request - Dalmex Recycling (OCC, SWL, Mixed Paper)\n\nHi [NAME],\n\nI\'m Robert with Dalmex Recycling in Dallas. We\'re a waste management company generating consistent volumes of recovered fiber including OCC, SWL, mixed paper, and other grades.\n\nWe\'re looking for buyers who offer competitive pricing. I\'d love to get your current rates on:\n\n‚Ä¢ OCC (Old Corrugated Containers)\n‚Ä¢ SWL (Sorted White Ledger)\n‚Ä¢ Mixed Paper\n‚Ä¢ CBS (Coated Book Stock)\n‚Ä¢ HWEC (High White Envelope Cuttings)\n\nYou can submit your pricing directly here:\n'+getShareLink()+'\n\nOr reply to this email with your current rates.\n\nLooking forward to connecting!\n\nRobert Vandling\nDalmex Recycling LLC\nDallas-Fort Worth, TX\nrvandling@dalmex.com';

var smsTemplate='Hi [NAME], this is Robert from Dalmex Recycling in Dallas. We generate consistent fiber volumes (OCC, SWL, mixed paper) and looking for buyers. What are your current rates? You can submit here: '+getShareLink();

var callScript='Hi, this is Robert Vandling calling from Dalmex Recycling in Dallas-Fort Worth.\n\nWe\'re a waste management company and we generate consistent volumes of recovered paper - OCC, sorted white ledger, mixed paper, and other grades.\n\nI\'m reaching out to see if you\'d be interested in receiving pricing on our material, or if you\'re buying, what your current rates are.\n\nQuestions to ask:\n‚Ä¢ What grades are you currently buying?\n‚Ä¢ What are your current prices per ton?\n‚Ä¢ What\'s your minimum load requirement?\n‚Ä¢ Do you pick up or do we deliver?\n\nClose: Great - I\'ll send you our pricing form. What\'s the best email to send that to?';

return '<div style="margin-bottom:14px"><h2 style="font-size:18px;font-weight:800;color:var(--text)">üìß Outreach Templates</h2><p style="font-size:10px;color:var(--text-muted)">Copy these templates when contacting leads</p></div>'+

'<div class="outreach-template"><div class="outreach-title">üìß Email Template</div><div class="outreach-text" id="emailTemplate">'+emailTemplate+'</div><button class="btn btn-primary btn-sm" onclick="copyText(\'emailTemplate\')">üìã Copy Email</button></div>'+

'<div class="outreach-template" style="background:linear-gradient(135deg,#f0fdf4,#dcfce7);border-color:var(--success)"><div class="outreach-title" style="color:#166534">üí¨ SMS Template</div><div class="outreach-text" id="smsTemplate">'+smsTemplate+'</div><button class="btn btn-success btn-sm" onclick="copyText(\'smsTemplate\')">üìã Copy SMS</button></div>'+

'<div class="outreach-template" style="background:linear-gradient(135deg,#fef3c7,#fde68a);border-color:var(--warning)"><div class="outreach-title" style="color:#92400e">üìû Call Script</div><div class="outreach-text">'+callScript+'</div></div>'+

'<div class="share-section"><div class="share-title">üîó Price Submission Link</div><p style="font-size:10px;color:var(--text-muted)">Send this link to buyers - they can submit their prices directly</p><div class="share-url" id="shareUrl">'+getShareLink()+'</div><div class="share-btns"><button class="btn btn-primary btn-sm" onclick="copyText(\'shareUrl\')">üìã Copy Link</button><button class="btn btn-success btn-sm" onclick="window.location.href=\'sms:?body=\'+encodeURIComponent(\'Submit your fiber prices to Dalmex Recycling: \'+getShareLink())">üì± Share via SMS</button><button class="btn btn-warning btn-sm" onclick="window.location.href=\'mailto:?subject=Price Request&body=\'+encodeURIComponent(\'Please submit your pricing here: \'+getShareLink())">‚úâÔ∏è Share via Email</button></div></div>'+

'<div class="qr-section"><div class="qr-title">üì± QR Code - Price Submission</div><p style="font-size:10px;color:var(--text-muted)">Print this or show on your phone for buyers to scan</p><div class="qr-code"><img src="'+getQRUrl()+'" alt="QR Code" style="width:150px;height:150px"></div></div>';
}

function copyText(id){
var text=document.getElementById(id).innerText;
navigator.clipboard.writeText(text);
toast('Copied to clipboard!');
}

function emailLead(id){
var l=leads.find(function(x){return x.id===id;});
if(!l||!l.email)return;
var name=l.contact?l.contact.split(' ')[0]:'there';
var body='Hi '+name+',\n\nI\'m Robert with Dalmex Recycling in Dallas. We generate consistent volumes of recovered fiber (OCC, SWL, mixed paper) and are looking for buyers.\n\nCould you share your current pricing? You can submit here: '+getShareLink()+'\n\nThanks!\nRobert Vandling\nDalmex Recycling';
window.location.href='mailto:'+l.email+'?subject='+encodeURIComponent('Price Request - Dalmex Recycling')+'&body='+encodeURIComponent(body);
updateStatus(id,'contacted');
}

function smsLead(id){
var l=leads.find(function(x){return x.id===id;});
if(!l||!l.phone)return;
var name=l.contact?l.contact.split(' ')[0]:'';
var msg='Hi'+(name?' '+name:'')+', this is Robert from Dalmex Recycling in Dallas. We have consistent fiber volumes (OCC, SWL, mixed paper). What are your current buying rates? Submit here: '+getShareLink();
window.location.href='sms:'+l.phone.replace(/[^0-9+]/g,'')+'?body='+encodeURIComponent(msg);
updateStatus(id,'contacted');
}

function callLead(id){
var l=leads.find(function(x){return x.id===id;});
if(!l||!l.phone)return;
window.location.href='tel:'+l.phone.replace(/[^0-9+]/g,'');
updateStatus(id,'contacted');
}

function updateStatus(id,status){
var l=leads.find(function(x){return x.id===id;});
if(l&&l.status==='new'){l.status=status;l.lastContact=new Date().toISOString();saveData();}
}

function updateLeadStatus(id){
var l=leads.find(function(x){return x.id===id;});
if(!l)return;
var statuses=['new','contacted','responded','converted'];
var current=statuses.indexOf(l.status);
var next=statuses[(current+1)%statuses.length];
l.status=next;
l.lastContact=new Date().toISOString();
saveData();renderNav();render();
toast('Status: '+next);
}

function deleteLead(id){
if(!confirm('Delete this lead?'))return;
leads=leads.filter(function(x){return x.id!==id;});
saveData();renderNav();render();
toast('Lead deleted');
}

function convertToBuyer(id){
var l=leads.find(function(x){return x.id===id;});
if(!l)return;
if(confirm('Convert '+l.company+' to active buyer?')){
buyers.push({
id:Date.now(),
company:l.company,
contact:l.contact||'',
email:l.email||'',
phone:l.phone||'',
type:l.type==='recycler'?'broker':l.type,
priority:false,
prices:{}
});
l.status='converted';
saveData();renderNav();render();
toast(l.company+' is now a buyer!');
}
}

function openLeadModal(){
document.getElementById('leadModalTitle').textContent='Add New Lead';
document.getElementById('lCompany').value='';
document.getElementById('lContact').value='';
document.getElementById('lTitle').value='';
document.getElementById('lEmail').value='';
document.getElementById('lPhone').value='';
document.getElementById('lType').value='mill';
document.getElementById('lRegion').value='';
document.getElementById('lMaterials').value='';
document.getElementById('lNotes').value='';
document.getElementById('leadModal').classList.add('active');
}

function closeLeadModal(){document.getElementById('leadModal').classList.remove('active');}

function saveLead(){
var company=document.getElementById('lCompany').value.trim();
if(!company){toast('Company name required');return;}
var materials=document.getElementById('lMaterials').value.split(',').map(function(m){return m.trim().toUpperCase();}).filter(function(m){return m;});
var newLead={
id:Date.now(),
company:company,
contact:document.getElementById('lContact').value.trim(),
title:document.getElementById('lTitle').value.trim(),
email:document.getElementById('lEmail').value.trim(),
phone:document.getElementById('lPhone').value.trim(),
type:document.getElementById('lType').value,
region:document.getElementById('lRegion').value.trim()||'',
materials:materials,
status:'new',
notes:document.getElementById('lNotes').value.trim(),
created:new Date().toISOString()
};
leads.unshift(newLead);
saveData();closeLeadModal();renderNav();render();
toast('Lead added!');
}
function renderBuyers(){
var f=buyers.slice().sort(function(a,b){return a.company.localeCompare(b.company);});
if(searchTerm)f=f.filter(function(b){return b.company.toLowerCase().indexOf(searchTerm.toLowerCase())>-1;});
if(filterType!=='all')f=f.filter(function(b){return b.type===filterType;});

return '<div style="margin-bottom:14px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px"><div><h2 style="font-size:18px;font-weight:800;color:var(--text)">üë• Active Buyers</h2><p style="font-size:10px;color:var(--text-muted)">Buyers who have submitted pricing or been verified</p></div>'+(isAdmin?'<button class="btn btn-primary btn-sm" onclick="openBuyerModal()">‚ûï Add Buyer</button>':'')+'</div>'+

'<div class="contacts-header"><div class="search-box"><span>üîç</span><input type="text" placeholder="Search buyers..." value="'+searchTerm+'" oninput="searchTerm=this.value;render()"></div><div class="filter-btns"><button class="filter-btn '+(filterType==='all'?'active':'')+'" onclick="filterType=\'all\';render()">All</button><button class="filter-btn '+(filterType==='mill'?'active':'')+'" onclick="filterType=\'mill\';render()">Mills</button><button class="filter-btn '+(filterType==='broker'?'active':'')+'" onclick="filterType=\'broker\';render()">Brokers</button><button class="filter-btn '+(filterType==='export'?'active':'')+'" onclick="filterType=\'export\';render()">Export</button></div></div>'+

'<div>'+f.map(function(b){
return '<div class="contact-card '+(b.priority?'priority':'')+'"><div class="contact-header"><div class="contact-name">'+b.company+'</div><span class="contact-type '+b.type+'">'+b.type+'</span></div><div class="contact-person">üë§ '+(b.contact||'No contact')+'</div>'+(b.email?'<div class="contact-email">‚úâÔ∏è '+b.email+'</div>':'')+(b.prices&&Object.keys(b.prices).length?'<div class="contact-prices">'+Object.keys(b.prices).filter(function(k){return b.prices[k];}).map(function(k){return '<div class="price-item"><div class="price-label">'+k+'</div><div class="price-value">$'+b.prices[k]+'</div></div>';}).join('')+'</div>':'<div style="padding:10px;background:var(--bg);border-radius:8px;font-size:10px;color:var(--text-muted);margin-bottom:8px">No prices yet - send price request link</div>')+'<div class="contact-actions">'+(b.phone?'<a href="tel:'+b.phone+'" class="contact-action call">üìû Call</a>':'')+(b.email?'<a href="mailto:'+b.email+'?subject=Price%20Request&body='+encodeURIComponent('Hi, please submit your current pricing here: '+getShareLink())+'" class="contact-action email">‚úâÔ∏è Request Prices</a>':'')+(isAdmin?'<button class="contact-action" onclick="openBuyerModal('+b.id+')">‚úèÔ∏è</button><button class="contact-action" style="color:var(--danger)" onclick="deleteBuyer('+b.id+')">üóëÔ∏è</button>':'')+'</div></div>';
}).join('')+'</div>';
}

function renderPrices(){
var cs=[{n:'OCC',d:marketPrices.OCC},{n:'SWL',d:marketPrices.SWL},{n:'PM',d:marketPrices.PM},{n:'CBS',d:marketPrices.CBS},{n:'HWEC',d:marketPrices.HWEC}];
var sorted=buyers.filter(function(b){return b.prices&&Object.keys(b.prices).length;}).sort(function(a,b){return(b.prices.OCC||0)-(a.prices.OCC||0);});

return '<div style="margin-bottom:12px"><h2 style="font-size:16px;font-weight:700;color:var(--text)">üí∞ Market Prices</h2><p style="font-size:10px;color:var(--text-muted)">Current market ranges for recovered fiber</p></div>'+

'<div class="prices-grid">'+cs.map(function(c){return '<div class="price-card"><div class="price-commodity">'+c.n+'</div><div class="price-current">$'+c.d.low+'-'+c.d.high+'</div><div class="price-range">per ton</div></div>';}).join('')+'</div>'+

'<div class="panel-card" style="margin-top:14px"><div class="panel-title">üìä Buyer Price Comparison</div>'+(sorted.length?'<div class="table-container"><table class="data-table"><thead><tr><th>Buyer</th><th>Type</th><th>OCC</th><th>SWL</th><th>PM</th><th>HWEC</th></tr></thead><tbody>'+sorted.map(function(b){return '<tr><td><strong>'+b.company+'</strong></td><td>'+b.type+'</td><td style="color:var(--profit);font-weight:700">'+(b.prices.OCC?'$'+b.prices.OCC:'-')+'</td><td style="color:var(--profit);font-weight:700">'+(b.prices.SWL?'$'+b.prices.SWL:'-')+'</td><td style="color:var(--profit);font-weight:700">'+(b.prices.PM?'$'+b.prices.PM:'-')+'</td><td style="color:var(--profit);font-weight:700">'+(b.prices.HWEC?'$'+b.prices.HWEC:'-')+'</td></tr>';}).join('')+'</tbody></table></div>':'<p style="font-size:11px;color:var(--text-muted);text-align:center;padding:20px">No buyer prices yet. Send the price request link to buyers.</p>')+'</div>';
}

function renderAdmin(){
if(!isAdmin)return '<p>Admin only</p>';
var pending=JSON.parse(localStorage.getItem('fh_pending')||'[]');

return '<div style="margin-bottom:14px"><h2 style="font-size:18px;font-weight:800;color:var(--text)">‚öôÔ∏è Admin Panel</h2></div>'+

'<div class="share-section"><div class="share-title">üîó Price Submission Link</div><div class="share-url">'+getShareLink()+'</div><div class="share-btns"><button class="btn btn-primary btn-sm" onclick="navigator.clipboard.writeText(getShareLink());toast(\'Copied!\')">üìã Copy</button></div></div>'+

(pending.length?'<div class="panel-card"><div class="panel-title">üì• Pending Submissions ('+pending.length+')</div>'+pending.map(function(p,i){return '<div style="padding:12px;background:var(--bg);border-radius:8px;margin-bottom:8px"><div style="display:flex;justify-content:space-between;align-items:start;flex-wrap:wrap;gap:8px"><div><strong style="font-size:13px">'+p.company+'</strong><div style="font-size:10px;color:var(--text-muted)">'+(p.contact||'')+(p.email?' ‚Ä¢ '+p.email:'')+(p.phone?' ‚Ä¢ '+p.phone:'')+'</div><div style="font-size:11px;margin-top:6px;color:var(--profit);font-weight:600">'+Object.keys(p.prices).map(function(k){return k+': $'+p.prices[k];}).join(' ‚Ä¢ ')+'</div></div><div style="display:flex;gap:6px"><button class="btn btn-sm btn-success" onclick="approvePending('+i+')">‚úì Approve</button><button class="btn btn-sm btn-danger" onclick="rejectPending('+i+')">‚úï Reject</button></div></div></div>';}).join('')+'</div>':'<div class="panel-card"><div style="text-align:center;padding:20px;color:var(--text-muted)"><div style="font-size:32px;margin-bottom:8px">üì≠</div><div style="font-size:12px">No pending submissions</div><div style="font-size:10px;margin-top:4px">Share your price submission link with buyers</div></div></div>')+

'<div class="admin-section"><div class="admin-section-title">üëë Admin Tools</div><div class="admin-grid"><button class="admin-btn" onclick="openBuyerModal()">‚ûï Add Buyer</button><button class="admin-btn" onclick="exportCSV()">üì• Export CSV</button><button class="admin-btn" onclick="clearAllData()">üóëÔ∏è Clear Data</button><button class="admin-btn" onclick="logoutAdmin()">üö™ Logout</button></div></div>';
}

function approvePending(i){
var pending=JSON.parse(localStorage.getItem('fh_pending')||'[]');
var p=pending[i];
if(!p)return;
var ex=buyers.find(function(b){return b.company.toLowerCase()===p.company.toLowerCase();});
if(ex){
Object.keys(p.prices).forEach(function(k){ex.prices[k]=p.prices[k];});
if(p.contact)ex.contact=p.contact;
if(p.email)ex.email=p.email;
if(p.phone)ex.phone=p.phone;
}else{
buyers.push({id:Date.now(),company:p.company,contact:p.contact||'',email:p.email||'',phone:p.phone||'',type:'mill',priority:false,prices:p.prices});
}
// Update lead status if exists
var lead=leads.find(function(l){return l.company.toLowerCase()===p.company.toLowerCase();});
if(lead)lead.status='responded';
pending.splice(i,1);
localStorage.setItem('fh_pending',JSON.stringify(pending));
saveData();renderNav();render();
toast('Approved - '+p.company);
}

function rejectPending(i){
var pending=JSON.parse(localStorage.getItem('fh_pending')||'[]');
pending.splice(i,1);
localStorage.setItem('fh_pending',JSON.stringify(pending));
render();
toast('Rejected');
}

function exportCSV(){
var csv='Company,Contact,Email,Phone,Type,OCC,SWL,PM,CBS,HWEC\n'+buyers.map(function(b){return[b.company,b.contact||'',b.email||'',b.phone||'',b.type,b.prices.OCC||'',b.prices.SWL||'',b.prices.PM||'',b.prices.CBS||'',b.prices.HWEC||''].join(',');}).join('\n');
var a=document.createElement('a');
a.href='data:text/csv;charset=utf-8,'+encodeURIComponent(csv);
a.download='dalmex_buyers_'+new Date().toISOString().split('T')[0]+'.csv';
a.click();
toast('CSV downloaded');
}

function clearAllData(){
if(confirm('Clear ALL leads and reset buyers to defaults? This cannot be undone.')){
leads=[];
buyers=JSON.parse(JSON.stringify(defaultBuyers));
localStorage.removeItem('fh_pending');
saveData();renderNav();render();
toast('Data cleared');
}
}

function logoutAdmin(){
isAdmin=false;
document.getElementById('userBadge').textContent='Sales Rep';
document.getElementById('userBadge').classList.remove('admin');
document.getElementById('adminBtn').style.display='inline-block';
currentTab='resources';
renderNav();render();
}

function openBuyerModal(id){
if(!isAdmin){toast('Admin only');return;}
editBuyerId=id||null;
document.getElementById('buyerModalTitle').textContent=id?'Edit Buyer':'Add Buyer';
if(id){
var b=buyers.find(function(x){return x.id===id;});
if(b){
document.getElementById('bCompany').value=b.company||'';
document.getElementById('bContact').value=b.contact||'';
document.getElementById('bEmail').value=b.email||'';
document.getElementById('bPhone').value=b.phone||'';
document.getElementById('bType').value=b.type||'mill';
['OCC','DLK','SWL','PM','CBS','HWEC'].forEach(function(c){
var inp=document.getElementById('p'+c);
if(inp)inp.value=b.prices&&b.prices[c]||'';
});
}
}else{
document.getElementById('bCompany').value='';
document.getElementById('bContact').value='';
document.getElementById('bEmail').value='';
document.getElementById('bPhone').value='';
document.getElementById('bType').value='mill';
['OCC','DLK','SWL','PM','CBS','HWEC'].forEach(function(c){
var inp=document.getElementById('p'+c);
if(inp)inp.value='';
});
}
document.getElementById('buyerModal').classList.add('active');
}

function closeBuyerModal(){document.getElementById('buyerModal').classList.remove('active');editBuyerId=null;}

function saveBuyer(){
var pr={};
['OCC','DLK','SWL','PM','CBS','HWEC'].forEach(function(c){
var v=document.getElementById('p'+c).value;
if(v)pr[c]=parseInt(v);
});
var d={
company:document.getElementById('bCompany').value.trim(),
contact:document.getElementById('bContact').value.trim(),
email:document.getElementById('bEmail').value.trim(),
phone:document.getElementById('bPhone').value.trim(),
type:document.getElementById('bType').value,
priority:false,
prices:pr
};
if(!d.company){toast('Company required');return;}
if(editBuyerId){
var ix=buyers.findIndex(function(b){return b.id===editBuyerId;});
if(ix>-1)buyers[ix]=Object.assign({},buyers[ix],d);
}else{
d.id=Date.now();
buyers.push(d);
}
saveData();closeBuyerModal();renderNav();render();
toast('Saved!');
}

function deleteBuyer(id){
if(!isAdmin)return;
if(confirm('Delete this buyer?')){
buyers=buyers.filter(function(x){return x.id!==id;});
saveData();renderNav();render();
toast('Deleted');
}
}

init();
</script>
</body>
</html>
