<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<title>Dalmex Fiber Hub AI</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root{--primary:#6366f1;--primary-dark:#4f46e5;--success:#10b981;--warning:#f59e0b;--danger:#ef4444;--ai-purple:#8b5cf6;--ai-purple-dark:#7c3aed;--dark:#1e293b;--darker:#0f172a;--card-bg:#fff;--bg:#f1f5f9;--light:#e2e8f0;--text:#1e293b;--text-muted:#64748b;--header-bg:#fff;--table-header:#f1f5f9;--border:#e2e8f0;--profit:#10b981;--loss:#ef4444}
.theme-terminal{--primary:#22d3ee;--primary-dark:#0891b2;--success:#22c55e;--warning:#eab308;--danger:#ef4444;--ai-purple:#a855f7;--ai-purple-dark:#7c3aed;--dark:#0a0a0a;--darker:#000;--card-bg:#111;--bg:#0a0a0a;--light:#222;--text:#e4e4e7;--text-muted:#a1a1aa;--header-bg:#111;--table-header:#1a1a1a;--border:#333;--profit:#22c55e;--loss:#ef4444}
.theme-terminal body{background:#0a0a0a}.theme-terminal .ticker-wrap{background:linear-gradient(90deg,#000,#111)}.theme-terminal .header{background:#111;border-color:#333}.theme-terminal .nav-bar{background:#111;border-color:#333}.theme-terminal .panel-card,.theme-terminal .stat-card,.theme-terminal .contact-card,.theme-terminal .price-card,.theme-terminal .modal,.theme-terminal .news-card{background:#111;border:1px solid #333}.theme-terminal .data-table th{background:#1a1a1a}.theme-terminal .data-table td{border-color:#333}.theme-terminal .form-input,.theme-terminal .form-select,.theme-terminal .form-textarea,.theme-terminal .chat-input{background:#1a1a1a;border-color:#333;color:#e4e4e7}.theme-terminal .search-box{background:#111}.theme-terminal .filter-btn,.theme-terminal .sort-btn{background:#111;border-color:#333;color:#a1a1aa}.theme-terminal .filter-btn.active,.theme-terminal .sort-btn.active{background:#22d3ee;border-color:#22d3ee;color:#000}.theme-terminal .contact-prices,.theme-terminal .quick-action,.theme-terminal .best-buyer{background:#1a1a1a}.theme-terminal .footer{border-color:#333}.theme-terminal .brand-title{background:linear-gradient(135deg,#22d3ee,#a855f7);-webkit-background-clip:text}.theme-terminal .report-section{background:linear-gradient(135deg,#052e16,#14532d);border-color:#22c55e}.theme-terminal .report-title,.theme-terminal .report-date{color:#22c55e}.theme-terminal .highest-pair{background:linear-gradient(135deg,#422006,#713f12);border-color:#eab308}.theme-terminal .highest-pair-commodity,.theme-terminal .highest-pair-buyer{color:#fbbf24}
.theme-corporate{--primary:#1e3a5f;--primary-dark:#0f2744;--success:#059669;--warning:#d97706;--danger:#dc2626;--ai-purple:#1e3a5f;--ai-purple-dark:#0f2744;--dark:#1e3a5f;--darker:#0f2744;--card-bg:#fff;--bg:#f8fafc;--light:#e2e8f0;--text:#1e293b;--text-muted:#64748b;--header-bg:#1e3a5f;--table-header:#f1f5f9;--border:#cbd5e1;--profit:#059669;--loss:#dc2626}
.theme-corporate .header{background:#1e3a5f}.theme-corporate .brand-title{color:#fff;-webkit-text-fill-color:#fff}.theme-corporate .brand-sub{color:rgba(255,255,255,.7)}.theme-corporate .user-badge{background:rgba(255,255,255,.2);color:#fff}.theme-corporate .admin-login-btn{background:#fff;color:#1e3a5f}.theme-corporate .ticker-wrap{background:#0f2744}.theme-corporate .nav-btn{background:#e2e8f0}.theme-corporate .nav-btn.active{background:#1e3a5f}.theme-corporate .logo{background:#fff}.theme-corporate .chat-header{background:linear-gradient(135deg,#1e3a5f,#0f2744)}.theme-corporate .btn-purple{background:#1e3a5f}
*{margin:0;padding:0;box-sizing:border-box}body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;transition:all .3s}
.ticker-wrap{background:linear-gradient(90deg,var(--darker),var(--dark));padding:10px 0;overflow:hidden}.ticker{display:flex;animation:tickerScroll 45s linear infinite;width:max-content}@keyframes tickerScroll{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}.ticker-item{display:inline-flex;align-items:center;gap:8px;margin-right:50px;color:#f1f5f9;font-size:13px;white-space:nowrap}.ticker-badge{padding:2px 8px;border-radius:4px;font-size:10px;font-weight:700;text-transform:uppercase}.ticker-badge.price{background:var(--warning);color:#000}.ticker-badge.news{background:#3b82f6}.ticker-badge.alert{background:var(--danger)}
.header{background:var(--header-bg);padding:12px 20px;border-bottom:1px solid var(--border);position:sticky;top:0;z-index:100;transition:all .3s}.header-inner{max-width:1400px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px}.header-left{display:flex;align-items:center;gap:12px}.logo{width:45px;height:45px;background:linear-gradient(135deg,var(--ai-purple),var(--ai-purple-dark));border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:24px}.brand-title{font-size:20px;font-weight:800;background:linear-gradient(135deg,var(--ai-purple),var(--primary));-webkit-background-clip:text;-webkit-text-fill-color:transparent}.brand-sub{font-size:11px;color:var(--text-muted)}.header-right{display:flex;align-items:center;gap:10px;flex-wrap:wrap}.user-badge{background:var(--light);padding:6px 12px;border-radius:8px;font-size:12px;font-weight:600;color:var(--text)}.user-badge.admin{background:linear-gradient(135deg,var(--warning),#d97706);color:#fff}.admin-login-btn{padding:8px 14px;border:none;border-radius:8px;font-size:12px;font-weight:600;cursor:pointer;background:linear-gradient(135deg,var(--warning),#d97706);color:#fff}
.theme-selector{display:flex;gap:6px}.theme-btn{width:28px;height:28px;border-radius:6px;border:2px solid var(--border);cursor:pointer;transition:all .2s}.theme-btn:hover{transform:scale(1.1)}.theme-btn.active{border-color:var(--primary);box-shadow:0 0 0 2px var(--primary)}.theme-btn.t-default{background:linear-gradient(135deg,#8b5cf6,#6366f1)}.theme-btn.t-terminal{background:linear-gradient(135deg,#000,#22c55e)}.theme-btn.t-corporate{background:linear-gradient(135deg,#1e3a5f,#fff)}
.nav-bar{background:var(--card-bg);padding:10px 20px;border-bottom:1px solid var(--border);overflow-x:auto;transition:all .3s}.nav-inner{max-width:1400px;margin:0 auto;display:flex;gap:8px}.nav-btn{padding:10px 18px;border:none;background:var(--light);border-radius:10px;font-size:13px;font-weight:600;color:var(--text-muted);cursor:pointer;display:flex;align-items:center;gap:6px;white-space:nowrap;transition:all .2s}.nav-btn:hover{background:#e0e7ff;color:var(--primary)}.nav-btn.active{background:linear-gradient(135deg,var(--primary),var(--ai-purple));color:#fff}.nav-btn.admin-only{background:linear-gradient(135deg,var(--warning),#d97706);color:#fff}.nav-btn.intel{background:linear-gradient(135deg,#059669,var(--success));color:#fff}.nav-count{background:rgba(255,255,255,.3);padding:2px 8px;border-radius:6px;font-size:11px}
.main{max-width:1400px;margin:0 auto;padding:20px}
.login-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;z-index:1000;padding:20px}.login-overlay.active{display:flex}.login-card{background:var(--card-bg);border-radius:24px;padding:40px;width:100%;max-width:400px}.login-logo{width:70px;height:70px;background:linear-gradient(135deg,var(--warning),#d97706);border-radius:16px;display:flex;align-items:center;justify-content:center;font-size:36px;margin:0 auto 20px}.login-title{text-align:center;font-size:24px;font-weight:800;margin-bottom:8px;color:var(--text)}.login-subtitle{text-align:center;color:var(--text-muted);margin-bottom:25px;font-size:14px}.login-error{background:#fef2f2;color:var(--danger);padding:12px;border-radius:10px;margin-bottom:15px;font-size:13px;text-align:center;display:none}.login-error.show{display:block}.form-group{margin-bottom:18px}.form-label{display:block;margin-bottom:6px;font-weight:600;font-size:13px;color:var(--text-muted)}.form-input{width:100%;padding:14px 16px;border:2px solid var(--border);border-radius:12px;font-size:15px;font-family:inherit;background:var(--card-bg);color:var(--text)}.form-input:focus{outline:none;border-color:var(--primary)}.login-btn{width:100%;padding:16px;background:linear-gradient(135deg,var(--warning),#d97706);color:#fff;border:none;border-radius:12px;font-size:16px;font-weight:700;cursor:pointer;margin-top:10px}.login-cancel{width:100%;padding:12px;background:var(--light);color:var(--text);border:none;border-radius:12px;font-size:14px;font-weight:600;cursor:pointer;margin-top:10px}
.panel-card{background:var(--card-bg);border-radius:16px;padding:20px;box-shadow:0 4px 20px rgba(0,0,0,.08);margin-bottom:20px;transition:all .3s}.panel-title{font-size:14px;font-weight:700;color:var(--text-muted);margin-bottom:15px;text-transform:uppercase;display:flex;justify-content:space-between;align-items:center}
.btn{padding:12px 20px;border:none;border-radius:10px;font-size:14px;font-weight:600;cursor:pointer;display:inline-flex;align-items:center;gap:8px;transition:all .2s}.btn-primary{background:var(--primary);color:#fff}.btn-success{background:var(--success);color:#fff}.btn-warning{background:var(--warning);color:#fff}.btn-danger{background:var(--danger);color:#fff}.btn-outline{background:transparent;border:2px solid var(--border);color:var(--text)}.btn-sm{padding:8px 14px;font-size:12px}.btn-purple{background:linear-gradient(135deg,var(--ai-purple),var(--ai-purple-dark));color:#fff}.btn:hover{opacity:0.9;transform:translateY(-1px)}
.intel-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;margin-bottom:20px}
.intel-btn{background:var(--card-bg);border:2px solid var(--border);border-radius:16px;padding:20px;cursor:pointer;text-align:left;transition:all .2s}.intel-btn:hover{border-color:var(--primary);transform:translateY(-2px);box-shadow:0 8px 25px rgba(0,0,0,.1)}.intel-btn-icon{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;margin-bottom:10px}.intel-btn-title{font-size:14px;font-weight:700;margin-bottom:4px;color:var(--text)}.intel-btn-desc{font-size:11px;color:var(--text-muted)}
.gap-positive{color:var(--profit);font-weight:700}.gap-negative{color:var(--loss);font-weight:700}
.report-section{background:linear-gradient(135deg,#f0fdf4,#dcfce7);border:2px solid var(--success);border-radius:16px;padding:20px;margin-bottom:20px}
.report-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}.report-title{font-size:18px;font-weight:800;color:#166534}.report-date{font-size:12px;color:#166534}
.scorecard{display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:12px;margin-bottom:20px}.scorecard-item{background:var(--card-bg);border-radius:12px;padding:14px;text-align:center;border:1px solid var(--border)}.scorecard-value{font-size:24px;font-weight:800;color:var(--profit)}.scorecard-label{font-size:10px;color:var(--text-muted);text-transform:uppercase}
.bar-chart{margin:15px 0}.bar-row{display:flex;align-items:center;margin-bottom:10px}.bar-label{width:70px;font-size:12px;font-weight:600;color:var(--text)}.bar-container{flex:1;height:22px;background:var(--light);border-radius:6px;overflow:hidden;margin:0 10px}.bar-fill{height:100%;border-radius:6px;transition:width .5s}.bar-value{width:50px;font-size:12px;font-weight:700;text-align:right;color:var(--text)}
.highest-pair{background:linear-gradient(135deg,#fef3c7,#fde68a);border:2px solid var(--warning);border-radius:12px;padding:14px;margin-bottom:10px;display:flex;justify-content:space-between;align-items:center}
.highest-pair-commodity{font-size:14px;font-weight:700;color:#92400e}.highest-pair-buyer{font-size:12px;color:#92400e}.highest-pair-price{font-size:18px;font-weight:800;color:var(--profit)}.highest-pair-terms{font-size:10px;color:var(--text-muted)}
.ppi-compare{border-radius:12px;overflow:hidden;margin-bottom:15px;background:var(--card-bg)}.ppi-row{display:flex;padding:10px 12px;border-bottom:1px solid var(--border)}.ppi-row:last-child{border-bottom:none}.ppi-row.header{background:var(--table-header);font-weight:700;font-size:11px;text-transform:uppercase;color:var(--text-muted)}.ppi-commodity{flex:1;color:var(--text)}.ppi-value{width:70px;text-align:right;font-weight:600;color:var(--text);font-size:12px}.ppi-gap{width:80px;text-align:right;font-weight:700}
.news-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:16px;margin-bottom:20px}
.news-card{background:var(--card-bg);border-radius:16px;overflow:hidden;border:1px solid var(--border);transition:all .2s}.news-card:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(0,0,0,.1)}.news-image{height:80px;display:flex;align-items:center;justify-content:center;font-size:32px}.news-image.market{background:linear-gradient(135deg,#3b82f6,#1d4ed8)}.news-image.recycling{background:linear-gradient(135deg,#10b981,#059669)}.news-image.policy{background:linear-gradient(135deg,#f59e0b,#d97706)}.news-image.shipping{background:linear-gradient(135deg,#8b5cf6,#6d28d9)}.news-content{padding:16px}.news-source{display:inline-block;padding:3px 8px;background:var(--light);border-radius:4px;font-size:10px;font-weight:600;text-transform:uppercase;color:var(--text-muted);margin-bottom:8px}.news-title{font-size:14px;font-weight:700;margin-bottom:6px;color:var(--text);line-height:1.3}.news-excerpt{font-size:12px;color:var(--text-muted);line-height:1.5;margin-bottom:10px}.news-link{display:inline-flex;align-items:center;gap:4px;font-size:12px;font-weight:600;color:var(--primary);text-decoration:none}.news-link:hover{text-decoration:underline}
.source-list{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;margin-top:15px}.source-item{display:flex;align-items:center;gap:10px;padding:12px;background:var(--bg);border-radius:10px;text-decoration:none;color:var(--text);transition:all .2s}.source-item:hover{background:var(--light);transform:translateX(4px)}.source-icon{width:36px;height:36px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:18px}.source-name{font-size:13px;font-weight:600}.source-type{font-size:10px;color:var(--text-muted)}
.forecast-card{background:linear-gradient(135deg,#eff6ff,#dbeafe);border:2px solid #3b82f6;border-radius:16px;padding:20px;margin-top:20px}.forecast-title{font-size:16px;font-weight:700;color:#1e40af;margin-bottom:10px;display:flex;align-items:center;gap:8px}.forecast-text{font-size:14px;line-height:1.7;color:#1e3a5f}
.theme-terminal .forecast-card{background:linear-gradient(135deg,#172554,#1e3a8a);border-color:#3b82f6}.theme-terminal .forecast-title,.theme-terminal .forecast-text{color:#93c5fd}
.trend-chart{margin:20px 0}.trend-row{display:flex;align-items:center;margin-bottom:8px}.trend-label{width:60px;font-size:11px;font-weight:600;color:var(--text-muted)}.trend-line{flex:1;height:30px;display:flex;align-items:center;gap:2px;padding:0 10px}.trend-point{width:8px;height:8px;border-radius:50%;background:var(--profit)}.trend-point.down{background:var(--loss)}.trend-value{width:60px;font-size:12px;font-weight:700;text-align:right;color:var(--text)}
.sort-btns{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:15px}.sort-btn{padding:6px 12px;border:2px solid var(--border);background:var(--card-bg);border-radius:8px;font-size:12px;font-weight:600;cursor:pointer;color:var(--text-muted)}.sort-btn.active{border-color:var(--primary);background:#e0e7ff;color:var(--primary)}
.ai-container{display:grid;grid-template-columns:1fr 320px;gap:20px}@media(max-width:1024px){.ai-container{grid-template-columns:1fr}}.chat-panel{background:var(--card-bg);border-radius:16px;overflow:hidden}.chat-header{background:linear-gradient(135deg,var(--ai-purple),var(--ai-purple-dark));color:#fff;padding:20px;display:flex;align-items:center;gap:15px}.chat-avatar{width:50px;height:50px;background:rgba(255,255,255,.2);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:28px}.chat-title{font-size:18px;font-weight:700}.chat-status{font-size:12px;opacity:.8}.chat-messages{height:380px;overflow-y:auto;padding:20px;background:var(--bg)}.msg{display:flex;gap:12px;margin-bottom:16px}.msg.user{flex-direction:row-reverse}.msg-avatar{width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0}.msg.ai .msg-avatar{background:linear-gradient(135deg,var(--ai-purple),var(--ai-purple-dark))}.msg.user .msg-avatar{background:var(--primary)}.msg-content{max-width:80%;padding:14px 18px;border-radius:16px;font-size:14px;line-height:1.6;white-space:pre-wrap}.msg.ai .msg-content{background:var(--card-bg);border:1px solid var(--border);color:var(--text)}.msg.user .msg-content{background:var(--primary);color:#fff}.chat-input-area{padding:15px 20px;background:var(--card-bg);border-top:1px solid var(--border);display:flex;gap:10px}.chat-input{flex:1;padding:14px 18px;border:2px solid var(--border);border-radius:12px;font-size:14px;font-family:inherit;background:var(--bg);color:var(--text)}.chat-input:focus{outline:none;border-color:var(--ai-purple)}
.side-panel{display:flex;flex-direction:column;gap:15px}.quick-action{display:flex;align-items:center;gap:12px;padding:10px;background:var(--bg);border-radius:10px;margin-bottom:6px;cursor:pointer;border:none;width:100%;text-align:left;font-family:inherit;transition:all .2s}.quick-action:hover{background:var(--light);transform:translateX(4px)}.quick-action-icon{width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:16px}.quick-action-text{font-size:12px;font-weight:600;color:var(--text)}.best-buyer{display:flex;align-items:center;justify-content:space-between;padding:10px;background:var(--bg);border-radius:10px;margin-bottom:6px}.best-buyer-info{display:flex;align-items:center;gap:8px}.best-buyer-rank{width:24px;height:24px;background:linear-gradient(135deg,var(--warning),#fbbf24);border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:700;color:#fff}.best-buyer-name{font-size:12px;font-weight:600;color:var(--text)}.best-buyer-price{font-size:14px;font-weight:700;color:var(--profit)}
.dashboard-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:14px;margin-bottom:20px}.stat-card{background:var(--card-bg);border-radius:16px;padding:18px;transition:all .3s}.stat-icon{width:40px;height:40px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;margin-bottom:10px}.stat-icon.purple{background:linear-gradient(135deg,var(--ai-purple),var(--ai-purple-dark))}.stat-icon.green{background:linear-gradient(135deg,var(--success),#059669)}.stat-icon.yellow{background:linear-gradient(135deg,var(--warning),#d97706)}.stat-icon.blue{background:linear-gradient(135deg,var(--primary),var(--primary-dark))}.stat-value{font-size:26px;font-weight:800;margin-bottom:4px;color:var(--text)}.stat-label{font-size:11px;color:var(--text-muted)}
.contacts-header{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:15px;margin-bottom:20px}.search-box{display:flex;align-items:center;gap:10px;background:var(--card-bg);padding:10px 16px;border-radius:12px;flex:1;max-width:400px;border:1px solid var(--border)}.search-box input{border:none;background:none;flex:1;font-size:14px;font-family:inherit;color:var(--text)}.search-box input:focus{outline:none}.filter-btns{display:flex;gap:8px;flex-wrap:wrap}.filter-btn{padding:8px 16px;border:2px solid var(--border);background:var(--card-bg);border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;color:var(--text-muted)}.filter-btn.active{border-color:var(--primary);background:#e0e7ff;color:var(--primary)}.contacts-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:14px}.contact-card{background:var(--card-bg);border-radius:16px;padding:18px;border:2px solid transparent;transition:all .3s}.contact-card.priority{border-color:var(--warning)}.contact-header{display:flex;justify-content:space-between;align-items:start;margin-bottom:10px}.contact-name{font-size:15px;font-weight:700;color:var(--text)}.contact-type{display:inline-block;padding:4px 10px;border-radius:6px;font-size:10px;font-weight:600;text-transform:uppercase}.contact-type.mill{background:#dbeafe;color:#1d4ed8}.contact-type.broker{background:#fef3c7;color:#b45309}.contact-type.export{background:#d1fae5;color:#047857}.contact-person{font-size:12px;color:var(--text-muted);margin-bottom:6px}.contact-email{font-size:11px;color:var(--primary);margin-bottom:8px}.contact-prices{display:grid;grid-template-columns:repeat(auto-fit,minmax(50px,1fr));gap:6px;margin-bottom:10px;padding:10px;background:var(--bg);border-radius:8px}.price-item{text-align:center}.price-label{font-size:9px;color:var(--text-muted);text-transform:uppercase}.price-value{font-size:12px;font-weight:700;color:var(--profit)}.contact-actions{display:flex;gap:6px;flex-wrap:wrap}.contact-action{padding:8px 12px;background:var(--bg);border:none;border-radius:6px;font-size:11px;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:4px;color:var(--text)}.contact-action:hover{background:var(--light)}.contact-action.call{background:#d1fae5;color:#047857}.contact-action.email{background:#dbeafe;color:#1d4ed8}.contact-action.edit{color:var(--primary)}.contact-action.delete{color:var(--danger)}
.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:1000;padding:20px}.modal-overlay.active{display:flex}.modal{background:var(--card-bg);border-radius:20px;width:100%;max-width:600px;max-height:90vh;overflow-y:auto}.modal-header{padding:20px 24px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;background:var(--card-bg)}.modal-title{font-size:18px;font-weight:700;color:var(--text)}.modal-close{width:36px;height:36px;border-radius:10px;border:none;background:var(--light);cursor:pointer;font-size:18px;display:flex;align-items:center;justify-content:center;color:var(--text)}.modal-body{padding:24px}.modal-footer{padding:16px 24px;border-top:1px solid var(--border);display:flex;justify-content:flex-end;gap:10px;position:sticky;bottom:0;background:var(--card-bg)}.form-row{display:grid;grid-template-columns:1fr 1fr;gap:16px}@media(max-width:500px){.form-row{grid-template-columns:1fr}}.form-select{width:100%;padding:12px 16px;border:2px solid var(--border);border-radius:10px;font-size:14px;font-family:inherit;background:var(--card-bg);color:var(--text)}.checkbox-group{display:flex;flex-wrap:wrap;gap:10px}.checkbox-item{display:flex;align-items:center;gap:6px;padding:8px 12px;background:var(--bg);border-radius:8px}.checkbox-item input{width:16px;height:16px}.checkbox-item label{font-size:13px;font-weight:500;color:var(--text)}.switch-group{display:flex;align-items:center;gap:10px}.switch{width:48px;height:26px;background:var(--light);border-radius:13px;position:relative;cursor:pointer}.switch.active{background:var(--success)}.switch::after{content:'';position:absolute;width:22px;height:22px;background:#fff;border-radius:50%;top:2px;left:2px;transition:all .2s}.switch.active::after{left:24px}.form-textarea{width:100%;padding:12px 16px;border:2px solid var(--border);border-radius:10px;font-size:14px;font-family:inherit;resize:vertical;min-height:80px;background:var(--card-bg);color:var(--text)}.price-input-group{display:grid;grid-template-columns:repeat(auto-fit,minmax(80px,1fr));gap:10px}.price-input-item label{display:block;font-size:11px;font-weight:600;color:var(--text-muted);margin-bottom:4px}.price-input-item input{width:100%;padding:8px 10px;border:2px solid var(--border);border-radius:8px;font-size:13px;background:var(--card-bg);color:var(--text)}
.table-container{overflow-x:auto;background:var(--card-bg);border-radius:16px}.data-table{width:100%;border-collapse:collapse;font-size:13px}.data-table th{background:var(--table-header);padding:12px 10px;text-align:left;font-weight:600;font-size:10px;text-transform:uppercase;color:var(--text-muted)}.data-table td{padding:10px;border-bottom:1px solid var(--border);color:var(--text)}.data-table tr:hover{background:var(--bg)}
.admin-section{background:linear-gradient(135deg,#fef3c7,#fde68a);border:2px solid var(--warning);border-radius:16px;padding:20px;margin-bottom:20px}.admin-section-title{font-size:16px;font-weight:700;color:#92400e;margin-bottom:15px}.admin-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:10px}.admin-btn{padding:12px 16px;background:#fff;border:2px solid var(--warning);border-radius:10px;font-size:12px;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:8px;color:#92400e}.admin-btn:hover{background:var(--warning);color:#fff}
.share-section{background:linear-gradient(135deg,#dbeafe,#bfdbfe);border:2px solid var(--primary);border-radius:16px;padding:20px;margin-bottom:20px}.share-title{font-size:16px;font-weight:700;color:#1e40af;margin-bottom:10px}.share-url{background:#fff;padding:12px;border-radius:8px;font-size:11px;word-break:break-all;margin:10px 0;border:1px solid var(--primary);color:var(--text)}.share-btns{display:flex;gap:10px;flex-wrap:wrap}
.prices-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:14px}.price-card{background:var(--card-bg);border-radius:16px;padding:16px;transition:all .3s}.price-commodity{font-size:13px;font-weight:700;color:var(--text)}.price-current{font-size:24px;font-weight:800;color:var(--profit);margin-bottom:4px}.price-range{font-size:10px;color:var(--text-muted)}
.buyer-form-container{max-width:500px;margin:0 auto;padding:20px}.buyer-form-card{background:var(--card-bg);border-radius:20px;padding:30px;box-shadow:0 10px 40px rgba(0,0,0,.1)}.buyer-form-logo{width:60px;height:60px;background:linear-gradient(135deg,var(--ai-purple),var(--ai-purple-dark));border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:30px;margin:0 auto 20px}.buyer-form-title{text-align:center;font-size:22px;font-weight:800;margin-bottom:5px;color:var(--text)}.buyer-form-subtitle{text-align:center;color:var(--text-muted);font-size:13px;margin-bottom:25px}.buyer-form-success{background:#d1fae5;color:#047857;padding:20px;border-radius:12px;text-align:center}
.toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%) translateY(100px);background:var(--dark);color:#fff;padding:14px 24px;border-radius:12px;font-size:14px;font-weight:500;z-index:2000;opacity:0;transition:all .3s}.toast.show{transform:translateX(-50%) translateY(0);opacity:1}
.footer{text-align:center;padding:30px 20px;color:var(--text-muted);font-size:12px;border-top:1px solid var(--border);margin-top:40px;transition:all .3s}
@media print{.header,.nav-bar,.ticker-wrap,.footer,.btn,.contact-actions,.no-print,.theme-selector{display:none!important}.main{padding:0}}
@media(max-width:768px){.header-inner{flex-direction:column}.ai-container{grid-template-columns:1fr}.chat-messages{height:280px}.dashboard-grid{grid-template-columns:repeat(2,1fr)}.contacts-grid{grid-template-columns:1fr}.intel-grid{grid-template-columns:1fr}.news-grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<div id="appContainer"></div>
<div class="login-overlay" id="adminLogin">
<div class="login-card">
<div class="login-logo">üëë</div>
<h2 class="login-title">Admin Login</h2>
<p class="login-subtitle">RJVandling access only</p>
<div class="login-error" id="loginError"></div>
<div class="form-group"><label class="form-label">Username</label><input type="text" class="form-input" id="username" placeholder="Username"></div>
<div class="form-group"><label class="form-label">Password</label><input type="password" class="form-input" id="password" placeholder="Password"></div>
<button class="login-btn" onclick="handleAdminLogin()">üîê Login</button>
<button class="login-cancel" onclick="hideAdminLogin()">Cancel</button>
</div>
</div>
<div class="modal-overlay" id="contactModal">
<div class="modal">
<div class="modal-header"><h3 class="modal-title" id="modalTitle">Add Contact</h3><button class="modal-close" onclick="closeModal()">√ó</button></div>
<div class="modal-body">
<form id="contactForm">
<div class="form-row"><div class="form-group"><label class="form-label">Company *</label><input type="text" class="form-input" id="fCompany" required></div><div class="form-group"><label class="form-label">Contact</label><input type="text" class="form-input" id="fContact"></div></div>
<div class="form-row"><div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" id="fEmail"></div><div class="form-group"><label class="form-label">Phone</label><input type="tel" class="form-input" id="fPhone"></div></div>
<div class="form-row"><div class="form-group"><label class="form-label">Type</label><select class="form-select" id="fType"><option value="mill">Mill</option><option value="broker">Broker</option><option value="export">Export</option></select></div><div class="form-group"><label class="form-label">Priority</label><div class="switch-group" style="margin-top:8px"><div class="switch" id="fPrioritySwitch" onclick="toggleSwitch()"></div><span style="color:var(--text)">Priority</span></div></div></div>
<div class="form-group"><label class="form-label">Commodities</label><div class="checkbox-group"><div class="checkbox-item"><input type="checkbox" name="comm" value="OCC" id="cOCC"><label for="cOCC">OCC</label></div><div class="checkbox-item"><input type="checkbox" name="comm" value="DLK" id="cDLK"><label for="cDLK">DLK</label></div><div class="checkbox-item"><input type="checkbox" name="comm" value="SWL" id="cSWL"><label for="cSWL">SWL</label></div><div class="checkbox-item"><input type="checkbox" name="comm" value="PM" id="cPM"><label for="cPM">PM</label></div><div class="checkbox-item"><input type="checkbox" name="comm" value="CBS" id="cCBS"><label for="cCBS">CBS</label></div><div class="checkbox-item"><input type="checkbox" name="comm" value="HWEC" id="cHWEC"><label for="cHWEC">HWEC</label></div></div></div>
<div class="form-group"><label class="form-label">Prices ($/ton)</label><div class="price-input-group"><div class="price-input-item"><label>OCC</label><input type="number" id="pOCC"></div><div class="price-input-item"><label>DLK</label><input type="number" id="pDLK"></div><div class="price-input-item"><label>SWL</label><input type="number" id="pSWL"></div><div class="price-input-item"><label>PM</label><input type="number" id="pPM"></div><div class="price-input-item"><label>CBS</label><input type="number" id="pCBS"></div><div class="price-input-item"><label>HWEC</label><input type="number" id="pHWEC"></div></div></div>
<div class="form-group"><label class="form-label">Notes</label><textarea class="form-textarea" id="fNotes"></textarea></div>
</form>
</div>
<div class="modal-footer"><button class="btn btn-outline" onclick="closeModal()">Cancel</button><button class="btn btn-primary" onclick="saveContact()">Save</button></div>
</div>
</div>
<div class="toast" id="toast"></div>
<script>
var adminUser={username:'RJVandling',password:'Sailer66',name:'Robert Vandling',email:'rvandling@dalmex.com'};
var defaultBuyers=[{id:1,company:'Georgia Pacific',contact:'Jake Walker',email:'jacob.walker1@gapac.com',phone:'555-123-4567',type:'mill',priority:true,commodities:['OCC','DLK','PM','SWL','HWEC'],prices:{OCC:65,PM:155,SWL:215,HWEC:370}},{id:2,company:'SKG Westrock',contact:'Cynthia Torres',email:'cynthia.torres@smurfitwestrock.com',phone:'555-234-5678',type:'mill',priority:true,commodities:['OCC','PM'],prices:{OCC:60}},{id:3,company:'Greenside',contact:'Casandra Espinoza',email:'grupocartonero.mty@gmail.com',phone:'555-345-6789',type:'export',priority:true,commodities:['OCC','PM','SWL'],prices:{OCC:58,PM:165,SWL:215}},{id:4,company:'American Fiber',contact:'Steve Minor',email:'sminor@amfiberservices.com',phone:'555-456-7890',type:'broker',priority:true,commodities:['SWL','CBS','HWEC'],prices:{SWL:215,CBS:160,HWEC:250}},{id:5,company:'Marck',contact:'Don Langley',email:'dlongley@marck.net',phone:'555-567-8901',type:'broker',priority:false,commodities:['OCC','SWL'],prices:{OCC:55,SWL:230}},{id:6,company:'Pratt Industries',contact:'',email:'',phone:'',type:'mill',priority:false,commodities:['OCC'],prices:{}},{id:7,company:'Future Foam',contact:'Tina Aaron',email:'tmaaron@futurefoam.com',phone:'555-678-9012',type:'mill',priority:false,commodities:['Foam'],prices:{}}];
var tickerItems=[{type:'price',text:'OCC: $55-65/ton'},{type:'price',text:'SWL: $215-230/ton'},{type:'news',text:'GP top OCC $65'},{type:'alert',text:'Next PPI: Jan 14'}];
var ppiData={OCC:{code:'WPU09120325',index:78.2,marketLow:55,marketHigh:70},SWL:{code:'WPU09120301',index:92.4,marketLow:200,marketHigh:240},PM:{code:'WPU0912',index:85.1,marketLow:145,marketHigh:175},CBS:{code:'WPU09120302',index:88.5,marketLow:150,marketHigh:180},HWEC:{code:'WPU09120303',index:95.2,marketLow:240,marketHigh:380},DLK:{code:'WPU09120304',index:82.3,marketLow:60,marketHigh:85}};
var marketPrices={OCC:{low:55,high:65},SWL:{low:215,high:230},PM:{low:155,high:165},CBS:{low:155,high:165},HWEC:{low:250,high:370}};
var newsSources=[{name:'Recycling Today',url:'https://www.recyclingtoday.com/news/fiber/',icon:'‚ôªÔ∏è',type:'Industry News',color:'#10b981'},{name:'Resource Recycling',url:'https://resource-recycling.com/recycling/',icon:'üì∞',type:'Trade Publication',color:'#3b82f6'},{name:'Waste Dive',url:'https://www.wastedive.com/topic/recycling/',icon:'üìä',type:'Business News',color:'#8b5cf6'},{name:'ISRI News',url:'https://www.isri.org/news-publications',icon:'üè≠',type:'Association',color:'#f59e0b'},{name:'Fastmarkets RISI',url:'https://www.fastmarkets.com/commodities/forest-products',icon:'üìà',type:'Market Data',color:'#ef4444'},{name:'Pulp & Paper Network',url:'https://www.pulpandpapernetwork.com/',icon:'üìÑ',type:'Industry',color:'#06b6d4'},{name:'AF&PA',url:'https://www.afandpa.org/news-resources',icon:'üå≤',type:'Association',color:'#22c55e'},{name:'Waste360',url:'https://www.waste360.com/recycling',icon:'üóëÔ∏è',type:'Trade Media',color:'#6366f1'},{name:'BLS PPI Data',url:'https://www.bls.gov/ppi/',icon:'üìâ',type:'Government',color:'#64748b'},{name:'FRED Economic Data',url:'https://fred.stlouisfed.org/series/WPU09120325',icon:'üèõÔ∏è',type:'Federal Reserve',color:'#1e3a5f'}];
var newsArticles=[{title:'OCC Prices Hold Steady as Mills Maintain Demand',source:'Recycling Today',category:'market',url:'https://www.recyclingtoday.com/news/fiber/',excerpt:'December OCC prices remain stable at $55-65/ton amid steady mill consumption and balanced supply.'},{title:'Mixed Paper Markets Face Continued Pressure',source:'Resource Recycling',category:'recycling',url:'https://resource-recycling.com/recycling/',excerpt:'Export restrictions continue to impact mixed paper markets as domestic capacity adjusts.'},{title:'EPA Updates Recycling Goals for 2025',source:'Waste Dive',category:'policy',url:'https://www.wastedive.com/topic/recycling/',excerpt:'New federal targets aim for 50% recycling rate with emphasis on paper fiber recovery.'},{title:'Container Shipping Rates Impact Export Markets',source:'ISRI',category:'shipping',url:'https://www.isri.org/news-publications',excerpt:'Rising freight costs affect recovered paper exports to Asian markets.'},{title:'January PPI Report Preview: Fiber Outlook',source:'Fastmarkets',category:'market',url:'https://www.fastmarkets.com/commodities/forest-products',excerpt:'Analysts expect stable to slightly higher prices in Q1 2026 fiber index.'},{title:'Packaging Demand Drives SWL Premiums',source:'Pulp & Paper',category:'recycling',url:'https://www.pulpandpapernetwork.com/',excerpt:'Sorted white ledger commands premium pricing as mills compete for quality grades.'}];
var isAdmin=false,isBuyerForm=false,currentTab='ai',currentTheme='default',buyers=[],activityLog=[],chat=[],searchTerm='',filterType='all',sortBy='name',editId=null;
function init(){var params=new URLSearchParams(window.location.search);if(params.get('submit')){isBuyerForm=true;renderBuyerForm(params.get('company')||'');}else{loadData();renderApp();}}
function loadData(){var b=localStorage.getItem('fh_buyers6');buyers=b?JSON.parse(b):JSON.parse(JSON.stringify(defaultBuyers));var a=localStorage.getItem('fh_activity');activityLog=a?JSON.parse(a):[];var t=localStorage.getItem('fh_theme');if(t)currentTheme=t;}
function saveData(){localStorage.setItem('fh_buyers6',JSON.stringify(buyers));localStorage.setItem('fh_activity',JSON.stringify(activityLog));localStorage.setItem('fh_theme',currentTheme);}
function logActivity(action){activityLog.unshift({time:new Date().toLocaleString(),action:action,user:isAdmin?'Admin':'System'});if(activityLog.length>50)activityLog.pop();saveData();}
function toast(m){var t=document.getElementById('toast');t.textContent=m;t.classList.add('show');setTimeout(function(){t.classList.remove('show')},3000);}
function setTheme(theme){currentTheme=theme;document.body.className='';if(theme!=='default')document.body.classList.add('theme-'+theme);document.querySelectorAll('.theme-btn').forEach(function(b){b.classList.remove('active');});var btn=document.querySelector('.theme-btn.t-'+theme);if(btn)btn.classList.add('active');saveData();}
function renderBuyerForm(company){document.getElementById('appContainer').innerHTML='<div class="buyer-form-container"><div class="buyer-form-card"><div class="buyer-form-logo">üí∞</div><h1 class="buyer-form-title">Submit Your Prices</h1><p class="buyer-form-subtitle">Dalmex Recycling - January 2026</p><div id="buyerFormContent"><div class="form-group"><label class="form-label">Company</label><input type="text" class="form-input" id="bfCompany" value="'+company+'" placeholder="Company name"></div><div class="form-group"><label class="form-label">Contact</label><input type="text" class="form-input" id="bfContact" placeholder="Your name"></div><div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" id="bfEmail" placeholder="your@email.com"></div><div class="form-group"><label class="form-label">Prices ($/ton)</label><div class="price-input-group"><div class="price-input-item"><label>OCC</label><input type="number" id="bfOCC" placeholder="$"></div><div class="price-input-item"><label>SWL</label><input type="number" id="bfSWL" placeholder="$"></div><div class="price-input-item"><label>PM</label><input type="number" id="bfPM" placeholder="$"></div><div class="price-input-item"><label>CBS</label><input type="number" id="bfCBS" placeholder="$"></div><div class="price-input-item"><label>HWEC</label><input type="number" id="bfHWEC" placeholder="$"></div><div class="price-input-item"><label>DLK</label><input type="number" id="bfDLK" placeholder="$"></div></div></div><button class="btn btn-success" style="width:100%;padding:16px" onclick="submitBuyerPrices()">‚úì Submit</button></div></div></div>';}
function submitBuyerPrices(){var company=document.getElementById('bfCompany').value.trim();if(!company){toast('Company required');return;}var prices={};['OCC','SWL','PM','CBS','HWEC','DLK'].forEach(function(c){var v=document.getElementById('bf'+c).value;if(v)prices[c]=parseInt(v);});var data={company:company,contact:document.getElementById('bfContact').value.trim(),email:document.getElementById('bfEmail').value.trim(),prices:prices,submitted:new Date().toISOString()};var pending=JSON.parse(localStorage.getItem('fh_pending')||'[]');pending.push(data);localStorage.setItem('fh_pending',JSON.stringify(pending));document.getElementById('buyerFormContent').innerHTML='<div class="buyer-form-success"><div style="font-size:48px;margin-bottom:15px">‚úÖ</div><h3>Thank You!</h3><p>Prices submitted.</p></div>';}
function renderApp(){document.getElementById('appContainer').innerHTML='<div class="app"><div class="ticker-wrap"><div class="ticker" id="ticker"></div></div><header class="header"><div class="header-inner"><div class="header-left"><div class="logo">ü§ñ</div><div><div class="brand-title">Dalmex Fiber Hub</div><div class="brand-sub">Commodity Intelligence ‚Ä¢ Dallas, TX</div></div></div><div class="header-right"><div class="theme-selector"><button class="theme-btn t-default '+(currentTheme==='default'?'active':'')+'" onclick="setTheme(\'default\')" title="Default"></button><button class="theme-btn t-terminal '+(currentTheme==='terminal'?'active':'')+'" onclick="setTheme(\'terminal\')" title="Trading Terminal"></button><button class="theme-btn t-corporate '+(currentTheme==='corporate'?'active':'')+'" onclick="setTheme(\'corporate\')" title="Corporate"></button></div><span class="user-badge" id="userBadge">Open Access</span><button class="admin-login-btn" id="adminBtn" onclick="showAdminLogin()">üëë Admin</button></div></div></header><nav class="nav-bar"><div class="nav-inner" id="navBar"></div></nav><main class="main" id="main"></main><footer class="footer">¬© 2025 Dalmex Recycling LLC ‚Ä¢ Robert Vandling</footer></div>';if(currentTheme!=='default')document.body.classList.add('theme-'+currentTheme);initTicker();renderNav();render();addWelcome();}
function showAdminLogin(){document.getElementById('adminLogin').classList.add('active');}
function hideAdminLogin(){document.getElementById('adminLogin').classList.remove('active');}
function handleAdminLogin(){var u=document.getElementById('username').value.trim(),p=document.getElementById('password').value;if(u.toLowerCase()===adminUser.username.toLowerCase()&&p===adminUser.password){isAdmin=true;hideAdminLogin();document.getElementById('userBadge').textContent='üëë '+adminUser.name;document.getElementById('userBadge').classList.add('admin');document.getElementById('adminBtn').style.display='none';logActivity('Admin logged in');renderNav();render();toast('Welcome Admin!');}else{document.getElementById('loginError').textContent='Invalid';document.getElementById('loginError').classList.add('show');}}
function logoutAdmin(){isAdmin=false;document.getElementById('userBadge').textContent='Open Access';document.getElementById('userBadge').classList.remove('admin');document.getElementById('adminBtn').style.display='inline-block';renderNav();render();}
function initTicker(){var tk=document.getElementById('ticker'),it=tickerItems.map(function(i){return '<div class="ticker-item"><span class="ticker-badge '+i.type+'">'+i.type.toUpperCase()+'</span> '+i.text+'</div>';}).join('');tk.innerHTML=it+it;}
function renderNav(){var tabs=[{id:'ai',icon:'ü§ñ',label:'AI'},{id:'intel',icon:'üìä',label:'Intel',intel:true},{id:'news',icon:'üì∞',label:'News'},{id:'dashboard',icon:'üìã',label:'Dashboard'},{id:'contacts',icon:'üë•',label:'Contacts',count:buyers.length},{id:'prices',icon:'üí∞',label:'Prices'}];if(isAdmin)tabs.push({id:'admin',icon:'‚öôÔ∏è',label:'Admin',adminOnly:true});document.getElementById('navBar').innerHTML=tabs.map(function(t){return '<button class="nav-btn '+(currentTab===t.id?'active':'')+' '+(t.adminOnly?'admin-only':'')+(t.intel?' intel':'')+'" onclick="setTab(\''+t.id+'\')">'+t.icon+' '+t.label+(t.count!==undefined?' <span class="nav-count">'+t.count+'</span>':'')+'</button>';}).join('');}
function setTab(t){currentTab=t;renderNav();render();}
function render(){var m=document.getElementById('main');if(currentTab==='ai')m.innerHTML=renderAI();else if(currentTab==='intel')m.innerHTML=renderIntel();else if(currentTab==='news')m.innerHTML=renderNews();else if(currentTab==='dashboard')m.innerHTML=renderDashboard();else if(currentTab==='contacts')m.innerHTML=renderContacts();else if(currentTab==='prices')m.innerHTML=renderPrices();else if(currentTab==='admin')m.innerHTML=renderAdmin();}
function getSorted(){var s=buyers.slice();if(sortBy==='occ')s.sort(function(a,b){return(b.prices&&b.prices.OCC||0)-(a.prices&&a.prices.OCC||0);});else if(sortBy==='swl')s.sort(function(a,b){return(b.prices&&b.prices.SWL||0)-(a.prices&&a.prices.SWL||0);});else s.sort(function(a,b){return a.company.localeCompare(b.company);});return s;}
function getHighestPair(commodity){var best=null,highPrice=0;buyers.forEach(function(b){if(b.prices&&b.prices[commodity]&&b.prices[commodity]>highPrice){highPrice=b.prices[commodity];best=b;}});return best?{buyer:best,price:highPrice}:null;}
function getAllHighestPairs(){var commodities=['OCC','SWL','PM','CBS','HWEC','DLK'];var pairs=[];commodities.forEach(function(c){var pair=getHighestPair(c);if(pair)pairs.push({commodity:c,buyer:pair.buyer.company,contact:pair.buyer.contact,price:pair.price,type:pair.buyer.type});});return pairs;}
function getPPIComparison(){var results=[];Object.keys(ppiData).forEach(function(c){var ppi=ppiData[c];var bestPair=getHighestPair(c);var ourPrice=bestPair?bestPair.price:0;var marketMid=(ppi.marketLow+ppi.marketHigh)/2;var gap=ourPrice-marketMid;results.push({commodity:c,ppiCode:ppi.code,ppiIndex:ppi.index,marketRange:ppi.marketLow+'-'+ppi.marketHigh,ourPrice:ourPrice,gap:gap});});return results;}
function getVolumeData(){return{OCC:85,SWL:45,PM:62,CBS:28,HWEC:15,DLK:32};}
function renderIntel(){return '<div style="margin-bottom:20px"><h2 style="font-size:22px;font-weight:800;color:var(--text)">üìä Commodity Intelligence</h2><p style="color:var(--text-muted);font-size:13px">Market analysis & pricing tools</p></div><div class="intel-grid"><div class="intel-btn" onclick="showPPICompare()"><div class="intel-btn-icon" style="background:linear-gradient(135deg,#3b82f6,#1d4ed8)">üìà</div><div class="intel-btn-title">PPI vs Pricing</div><div class="intel-btn-desc">Compare market index to buyers</div></div><div class="intel-btn" onclick="showHighestPairs()"><div class="intel-btn-icon" style="background:linear-gradient(135deg,var(--warning),#d97706)">üèÜ</div><div class="intel-btn-title">Highest Pairs</div><div class="intel-btn-desc">Best buyer per commodity</div></div><div class="intel-btn" onclick="showIndustryReport()"><div class="intel-btn-icon" style="background:linear-gradient(135deg,var(--success),#059669)">üìã</div><div class="intel-btn-title">Industry Report</div><div class="intel-btn-desc">Volume & trends</div></div><div class="intel-btn" onclick="setTab(\'news\')"><div class="intel-btn-icon" style="background:linear-gradient(135deg,#8b5cf6,#6d28d9)">üì∞</div><div class="intel-btn-title">Industry News</div><div class="intel-btn-desc">Latest market updates</div></div></div><div id="intelResults"></div>';}
function showPPICompare(){var data=getPPIComparison();var html='<div class="panel-card"><div class="panel-title">üìà PPI vs Current Pricing</div><div class="ppi-compare"><div class="ppi-row header"><div class="ppi-commodity">Commodity</div><div class="ppi-value">Index</div><div class="ppi-value">Market</div><div class="ppi-value">Your Best</div><div class="ppi-gap">Gap</div></div>';data.forEach(function(d){var gapClass=d.gap>=0?'gap-positive':'gap-negative';var gapSign=d.gap>=0?'+':'';html+='<div class="ppi-row"><div class="ppi-commodity"><strong>'+d.commodity+'</strong><br><span style="font-size:9px;color:var(--text-muted)">'+d.ppiCode+'</span></div><div class="ppi-value">'+d.ppiIndex+'</div><div class="ppi-value">$'+d.marketRange+'</div><div class="ppi-value" style="color:var(--profit)">'+(d.ourPrice?'$'+d.ourPrice:'-')+'</div><div class="ppi-gap '+gapClass+'">'+(d.ourPrice?gapSign+'$'+d.gap.toFixed(0):'-')+'</div></div>';});html+='</div></div>';html+='<div class="forecast-card"><div class="forecast-title">üîÆ AI Forecast</div><div class="forecast-text">Based on PPI trends, <strong>OCC</strong> expected stable at $55-65 through Q1. <strong>SWL</strong> showing strength - consider locking contracts with Marck at $230. Watch for mill maintenance schedules in Feb that may tighten supply.</div></div>';document.getElementById('intelResults').innerHTML=html;}
function showHighestPairs(){var pairs=getAllHighestPairs();var html='<div class="panel-card"><div class="panel-title">üèÜ Highest Paying Buyer Per Commodity</div>';pairs.forEach(function(p){html+='<div class="highest-pair"><div><div class="highest-pair-commodity">'+p.commodity+'</div><div class="highest-pair-buyer">'+p.buyer+(p.contact?' ‚Ä¢ '+p.contact:'')+'</div><div class="highest-pair-terms"><span class="contact-type '+p.type+'">'+p.type+'</span></div></div><div style="text-align:right"><div class="highest-pair-price">$'+p.price+'</div><div style="font-size:10px;color:var(--text-muted)">per ton</div></div></div>';});html+='</div>';document.getElementById('intelResults').innerHTML=html;}
function showIndustryReport(){var pairs=getAllHighestPairs();var volumes=getVolumeData();var totalVolume=Object.values(volumes).reduce(function(a,b){return a+b;},0);var avgPrice=pairs.length?Math.round(pairs.reduce(function(a,p){return a+p.price;},0)/pairs.length):0;var topPairs=pairs.sort(function(a,b){return b.price-a.price;}).slice(0,3);var html='<div class="report-section"><div class="report-header"><div class="report-title">üìã Performance Report</div><div class="report-date">'+new Date().toLocaleDateString()+'</div></div><div class="scorecard"><div class="scorecard-item"><div class="scorecard-value">'+totalVolume+'%</div><div class="scorecard-label">Volume</div></div><div class="scorecard-item"><div class="scorecard-value">$'+avgPrice+'</div><div class="scorecard-label">Avg Price</div></div><div class="scorecard-item"><div class="scorecard-value">'+buyers.length+'</div><div class="scorecard-label">Buyers</div></div><div class="scorecard-item"><div class="scorecard-value">'+pairs.length+'</div><div class="scorecard-label">Grades</div></div></div></div>';html+='<div class="panel-card"><div class="panel-title">üìä Volume Distribution</div><div class="bar-chart">';Object.keys(volumes).forEach(function(c){var pct=volumes[c];var color=pct>70?'var(--profit)':pct>40?'var(--warning)':'var(--loss)';html+='<div class="bar-row"><div class="bar-label">'+c+'</div><div class="bar-container"><div class="bar-fill" style="width:'+pct+'%;background:'+color+'"></div></div><div class="bar-value">'+pct+'%</div></div>';});html+='</div></div>';html+='<div class="panel-card"><div class="panel-title">üèÖ Top 3 Commodities</div><div class="table-container"><table class="data-table"><thead><tr><th>#</th><th>Grade</th><th>Buyer</th><th>Price</th></tr></thead><tbody>';topPairs.forEach(function(p,i){html+='<tr><td><strong>'+(i+1)+'</strong></td><td><strong>'+p.commodity+'</strong></td><td>'+p.buyer+'</td><td style="color:var(--profit);font-weight:700">$'+p.price+'</td></tr>';});html+='</tbody></table></div></div>';html+='<div class="forecast-card"><div class="forecast-title">üîÆ Market Forecast</div><div class="forecast-text">Q1 2026 outlook: OCC stable, SWL premium holding, PM competitive. Consolidate OCC shipments to Georgia Pacific for max returns. Next BLS PPI release: January 14, 2026.</div></div>';html+='<div style="margin-top:15px" class="no-print"><button class="btn btn-outline" onclick="window.print()">üñ®Ô∏è Print Report</button></div>';document.getElementById('intelResults').innerHTML=html;}
function renderNews(){var html='<div style="margin-bottom:20px"><h2 style="font-size:22px;font-weight:800;color:var(--text)">üì∞ Industry News</h2><p style="color:var(--text-muted);font-size:13px">Latest market updates & resources</p></div>';html+='<div class="news-grid">';newsArticles.forEach(function(n){var cat=n.category;html+='<div class="news-card"><div class="news-image '+cat+'">'+(cat==='market'?'üìà':cat==='recycling'?'‚ôªÔ∏è':cat==='policy'?'üìã':'üö¢')+'</div><div class="news-content"><span class="news-source">'+n.source+'</span><h3 class="news-title">'+n.title+'</h3><p class="news-excerpt">'+n.excerpt+'</p><a href="'+n.url+'" target="_blank" class="news-link">Read More ‚Üí</a></div></div>';});html+='</div>';html+='<div class="panel-card"><div class="panel-title">üîó Industry Sources</div><p style="font-size:12px;color:var(--text-muted);margin-bottom:15px">Click to visit official sources for live market data and news</p><div class="source-list">';newsSources.forEach(function(s){html+='<a href="'+s.url+'" target="_blank" class="source-item"><div class="source-icon" style="background:'+s.color+'">'+s.icon+'</div><div><div class="source-name">'+s.name+'</div><div class="source-type">'+s.type+'</div></div></a>';});html+='</div></div>';html+='<div class="forecast-card"><div class="forecast-title">üîÆ News Analysis</div><div class="forecast-text">Key themes: <strong>OCC demand steady</strong> from domestic mills, <strong>export challenges</strong> persist with shipping costs, <strong>policy focus</strong> on recycling rates. Watch ISRI and AF&PA for industry positions on proposed regulations.</div></div>';return html;}
function renderAI(){var best=buyers.filter(function(b){return b.prices&&b.prices.OCC;}).sort(function(a,b){return b.prices.OCC-a.prices.OCC;}).slice(0,3);return '<div class="ai-container"><div class="chat-panel"><div class="chat-header"><div class="chat-avatar">ü§ñ</div><div><div class="chat-title">Commodity Bot</div><div class="chat-status">AI Market Analyst</div></div></div><div class="chat-messages" id="chatBox">'+chat.map(function(m){return '<div class="msg '+m.role+'"><div class="msg-avatar">'+(m.role==='ai'?'ü§ñ':'üë§')+'</div><div class="msg-content">'+m.content+'</div></div>';}).join('')+'</div><div class="chat-input-area"><input type="text" class="chat-input" id="chatInput" placeholder="Ask about prices, news, PPI..." onkeypress="if(event.key===\'Enter\')sendChat()"><button class="btn btn-purple" onclick="sendChat()">Send</button></div></div><div class="side-panel"><div class="panel-card"><div class="panel-title">Quick Actions</div><button class="quick-action" onclick="setTab(\'intel\');setTimeout(showPPICompare,100)"><div class="quick-action-icon" style="background:#dbeafe">üìà</div><div class="quick-action-text">PPI Compare</div></button><button class="quick-action" onclick="setTab(\'intel\');setTimeout(showHighestPairs,100)"><div class="quick-action-icon" style="background:#fef3c7">üèÜ</div><div class="quick-action-text">Highest Pairs</div></button><button class="quick-action" onclick="setTab(\'news\')"><div class="quick-action-icon" style="background:#f3e8ff">üì∞</div><div class="quick-action-text">Industry News</div></button><button class="quick-action" onclick="setTab(\'intel\');setTimeout(showIndustryReport,100)"><div class="quick-action-icon" style="background:#d1fae5">üìã</div><div class="quick-action-text">Full Report</div></button></div><div class="panel-card"><div class="panel-title">üé® Themes</div><button class="quick-action" onclick="setTheme(\'terminal\')"><div class="quick-action-icon" style="background:#000">üíπ</div><div class="quick-action-text">Trading Terminal</div></button><button class="quick-action" onclick="setTheme(\'corporate\')"><div class="quick-action-icon" style="background:#1e3a5f">üè¢</div><div class="quick-action-text">Corporate</div></button></div><div class="panel-card"><div class="panel-title">Top OCC</div>'+best.map(function(b,i){return '<div class="best-buyer"><div class="best-buyer-info"><div class="best-buyer-rank">'+(i+1)+'</div><div class="best-buyer-name">'+b.company+'</div></div><div class="best-buyer-price">$'+b.prices.OCC+'</div></div>';}).join('')+'</div></div></div>';}
function renderDashboard(){var mi=buyers.filter(function(b){return b.type==='mill';}).length,op=buyers.filter(function(b){return b.prices&&b.prices.OCC;}).map(function(b){return b.prices.OCC;}),av=op.length?Math.round(op.reduce(function(a,b){return a+b;},0)/op.length):0;var sorted=getSorted().filter(function(b){return b.prices&&Object.keys(b.prices).length;});return '<div class="dashboard-grid"><div class="stat-card"><div class="stat-icon purple">üë•</div><div class="stat-value">'+buyers.length+'</div><div class="stat-label">Buyers</div></div><div class="stat-card"><div class="stat-icon green">üí∞</div><div class="stat-value">$'+av+'</div><div class="stat-label">Avg OCC</div></div><div class="stat-card"><div class="stat-icon blue">üè≠</div><div class="stat-value">'+mi+'</div><div class="stat-label">Mills</div></div></div><div class="panel-card"><div class="panel-title">Price Comparison</div><div class="sort-btns"><button class="sort-btn '+(sortBy==='name'?'active':'')+'" onclick="sortBy=\'name\';render()">A-Z</button><button class="sort-btn '+(sortBy==='occ'?'active':'')+'" onclick="sortBy=\'occ\';render()">OCC‚Üì</button><button class="sort-btn '+(sortBy==='swl'?'active':'')+'" onclick="sortBy=\'swl\';render()">SWL‚Üì</button></div><div class="table-container"><table class="data-table"><thead><tr><th>Buyer</th><th>Type</th><th>OCC</th><th>SWL</th><th>PM</th></tr></thead><tbody>'+sorted.map(function(b){return '<tr><td><strong>'+b.company+'</strong></td><td><span class="contact-type '+b.type+'">'+b.type+'</span></td><td style="color:var(--profit);font-weight:700">'+(b.prices.OCC?'$'+b.prices.OCC:'-')+'</td><td style="color:var(--profit);font-weight:700">'+(b.prices.SWL?'$'+b.prices.SWL:'-')+'</td><td style="color:var(--profit);font-weight:700">'+(b.prices.PM?'$'+b.prices.PM:'-')+'</td></tr>';}).join('')+'</tbody></table></div></div>';}
function renderContacts(){var f=getSorted();if(searchTerm){var s=searchTerm.toLowerCase();f=f.filter(function(b){return b.company.toLowerCase().indexOf(s)>-1;});}if(filterType!=='all')f=f.filter(function(b){return b.type===filterType;});return '<div class="contacts-header"><div class="search-box"><span>üîç</span><input type="text" placeholder="Search..." value="'+searchTerm+'" oninput="searchTerm=this.value;render()"></div><div class="filter-btns"><button class="filter-btn '+(filterType==='all'?'active':'')+'" onclick="filterType=\'all\';render()">All</button><button class="filter-btn '+(filterType==='mill'?'active':'')+'" onclick="filterType=\'mill\';render()">Mills</button><button class="filter-btn '+(filterType==='broker'?'active':'')+'" onclick="filterType=\'broker\';render()">Brokers</button></div>'+(isAdmin?'<button class="btn btn-primary btn-sm" onclick="openModal()">‚ûï Add</button>':'')+'</div><div class="contacts-grid">'+f.map(function(b){return '<div class="contact-card '+(b.priority?'priority':'')+'"><div class="contact-header"><div class="contact-name">'+b.company+'</div><span class="contact-type '+b.type+'">'+b.type+'</span></div><div class="contact-person">üë§ '+(b.contact||'No contact')+'</div>'+(b.email?'<div class="contact-email">‚úâÔ∏è '+b.email+'</div>':'')+(b.prices&&Object.keys(b.prices).length?'<div class="contact-prices">'+Object.keys(b.prices).filter(function(k){return b.prices[k];}).map(function(k){return '<div class="price-item"><div class="price-label">'+k+'</div><div class="price-value">$'+b.prices[k]+'</div></div>';}).join('')+'</div>':'')+'<div class="contact-actions">'+(b.phone?'<button class="contact-action call" onclick="callBuyer(\''+b.phone+'\')">üìû</button>':'')+(b.email?'<button class="contact-action email" onclick="emailBuyer('+b.id+')">‚úâÔ∏è</button>':'')+(isAdmin?'<button class="contact-action edit" onclick="editContact('+b.id+')">‚úèÔ∏è</button><button class="contact-action delete" onclick="deleteContact('+b.id+')">üóëÔ∏è</button>':'')+'</div></div>';}).join('')+'</div>';}
function renderPrices(){var cs=[{n:'OCC',d:marketPrices.OCC},{n:'SWL',d:marketPrices.SWL},{n:'PM',d:marketPrices.PM},{n:'CBS',d:marketPrices.CBS},{n:'HWEC',d:marketPrices.HWEC}];return '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px"><h2 style="font-size:20px;font-weight:700;color:var(--text)">Market Prices - Dec 2025</h2><button class="btn btn-outline btn-sm" onclick="window.print()">üñ®Ô∏è Print</button></div><div class="prices-grid">'+cs.map(function(c){return '<div class="price-card"><div class="price-commodity">'+c.n+'</div><div class="price-current">$'+c.d.low+'-'+c.d.high+'</div><div class="price-range">per ton</div></div>';}).join('')+'</div>';}
function getShareLink(){return window.location.origin+window.location.pathname+'?submit=1';}
function renderAdmin(){if(!isAdmin)return '<p style="color:var(--text)">Access denied</p>';var pending=JSON.parse(localStorage.getItem('fh_pending')||'[]');return '<div class="share-section"><div class="share-title">üì§ Share Price Request</div><div class="share-url">'+getShareLink()+'</div><div class="share-btns"><button class="btn btn-primary btn-sm" onclick="copyLink()">üìã Copy</button><button class="btn btn-success btn-sm" onclick="textLink()">üì± Text</button><button class="btn btn-warning btn-sm" onclick="emailLink()">‚úâÔ∏è Email</button></div></div>'+(pending.length?'<div class="panel-card"><div class="panel-title">üì• Pending ('+pending.length+')</div>'+pending.map(function(p,i){return '<div style="padding:12px;background:var(--bg);border-radius:10px;margin-bottom:8px;display:flex;justify-content:space-between;align-items:center"><div style="color:var(--text)"><strong>'+p.company+'</strong><br><span style="font-size:11px">'+Object.keys(p.prices).map(function(k){return k+':$'+p.prices[k];}).join(' ')+'</span></div><div><button class="btn btn-sm btn-success" onclick="approvePending('+i+')">‚úì</button> <button class="btn btn-sm btn-danger" onclick="rejectPending('+i+')">‚úï</button></div></div>';}).join('')+'</div>':'')+'<div class="admin-section"><div class="admin-section-title">üëë Admin</div><div class="admin-grid"><button class="admin-btn" onclick="openModal()">‚ûï Add</button><button class="admin-btn" onclick="bccEmail()">üìß BCC</button><button class="admin-btn" onclick="exportCSV()">üì• CSV</button><button class="admin-btn" onclick="logoutAdmin()">üö™ Out</button></div></div>';}
function copyLink(){navigator.clipboard.writeText(getShareLink()).then(function(){toast('Copied!');});}
function textLink(){window.location.href='sms:?body='+encodeURIComponent('Submit prices: '+getShareLink());}
function emailLink(){window.location.href='mailto:?subject='+encodeURIComponent('Price Request')+'&body='+encodeURIComponent('Submit: '+getShareLink());}
function approvePending(i){var pending=JSON.parse(localStorage.getItem('fh_pending')||'[]');var p=pending[i];if(!p)return;var existing=buyers.find(function(b){return b.company.toLowerCase()===p.company.toLowerCase();});if(existing){Object.keys(p.prices).forEach(function(k){existing.prices[k]=p.prices[k];});if(p.contact)existing.contact=p.contact;if(p.email)existing.email=p.email;logActivity('Updated: '+p.company);}else{buyers.push({id:buyers.length+1,company:p.company,contact:p.contact,email:p.email,phone:'',type:'mill',priority:false,commodities:Object.keys(p.prices),prices:p.prices});logActivity('Added: '+p.company);}pending.splice(i,1);localStorage.setItem('fh_pending',JSON.stringify(pending));saveData();renderNav();render();toast('Approved');}
function rejectPending(i){var pending=JSON.parse(localStorage.getItem('fh_pending')||'[]');pending.splice(i,1);localStorage.setItem('fh_pending',JSON.stringify(pending));render();toast('Rejected');}
function callBuyer(phone){window.location.href='tel:'+phone.replace(/[^0-9]/g,'');}
function emailBuyer(id){var b=buyers.find(function(x){return x.id===id;});if(!b||!b.email)return;window.location.href='mailto:'+b.email+'?subject='+encodeURIComponent('Price Request');}
function bccEmail(){var emails=buyers.filter(function(b){return b.email;}).map(function(b){return b.email;}).join(',');window.location.href='mailto:?bcc='+emails+'&subject='+encodeURIComponent('Price Request')+'&body='+encodeURIComponent('Submit: '+getShareLink());}
function exportCSV(){var csv='Company,Contact,Email,Type,OCC,SWL,PM\n'+buyers.map(function(b){return [b.company,b.contact||'',b.email||'',b.type,b.prices&&b.prices.OCC||'',b.prices&&b.prices.SWL||'',b.prices&&b.prices.PM||''].join(',');}).join('\n');var a=document.createElement('a');a.href='data:text/csv;charset=utf-8,'+encodeURIComponent(csv);a.download='dalmex.csv';a.click();}
function addWelcome(){chat.push({role:'ai',content:'ü§ñ Commodity Intelligence Bot\n\nI can help with:\n‚Ä¢ "PPI comparison" - Market gaps\n‚Ä¢ "Highest pairs" - Best buyers\n‚Ä¢ "Industry news" - Latest updates\n‚Ä¢ "Full report" - Analysis\n‚Ä¢ "Dark mode" - Theme switch\n\nOr click üì∞ News tab!'});}
function sendChat(){var inp=document.getElementById('chatInput'),msg=inp.value.trim();if(!msg)return;chat.push({role:'user',content:msg});inp.value='';setTimeout(function(){chat.push({role:'ai',content:processAI(msg)});render();var bx=document.getElementById('chatBox');if(bx)bx.scrollTop=bx.scrollHeight;},300);render();}
function processAI(q){var ql=q.toLowerCase();if(ql.indexOf('news')>-1||ql.indexOf('article')>-1||ql.indexOf('update')>-1){return 'üì∞ Latest Industry News:\n\n1. OCC Prices Hold Steady\n   ‚Üí recyclingtoday.com\n\n2. Mixed Paper Markets Under Pressure\n   ‚Üí resource-recycling.com\n\n3. EPA Recycling Goals 2025\n   ‚Üí wastedive.com\n\nüìå Go to News tab for full articles & source links!';}if(ql.indexOf('source')>-1||ql.indexOf('link')>-1||ql.indexOf('website')>-1){return 'üîó Top Industry Sources:\n\n‚Ä¢ Recycling Today\n  recyclingtoday.com/news/fiber\n\n‚Ä¢ ISRI News\n  isri.org/news\n\n‚Ä¢ Fastmarkets RISI\n  fastmarkets.com\n\n‚Ä¢ BLS PPI Data\n  bls.gov/ppi\n\nüì∞ See News tab for all 10 sources!';}if(ql.indexOf('dark')>-1||ql.indexOf('terminal')>-1){setTheme('terminal');return 'üíπ Trading Terminal activated!';}if(ql.indexOf('corporate')>-1||ql.indexOf('white')>-1||ql.indexOf('light')>-1){setTheme('corporate');return 'üè¢ Corporate theme activated!';}if(ql.indexOf('default')>-1){setTheme('default');return 'üé® Default theme activated!';}if(ql.indexOf('ppi')>-1||ql.indexOf('compare')>-1||ql.indexOf('gap')>-1){var data=getPPIComparison();var response='üìà PPI vs Your Prices:\n\n';data.forEach(function(d){if(d.ourPrice){var sign=d.gap>=0?'+':'';response+=d.commodity+': $'+d.ourPrice+' ('+sign+'$'+d.gap.toFixed(0)+')\n';}});return response;}if(ql.indexOf('highest')>-1||ql.indexOf('pair')>-1||ql.indexOf('best buyer')>-1){var pairs=getAllHighestPairs();var response='üèÜ Highest Pairs:\n\n';pairs.forEach(function(p){response+=p.commodity+': '+p.buyer+' @ $'+p.price+'\n';});return response;}if(ql.indexOf('forecast')>-1||ql.indexOf('predict')>-1||ql.indexOf('outlook')>-1){return 'üîÆ Q1 2026 Forecast:\n\n‚Ä¢ OCC: Stable $55-65\n‚Ä¢ SWL: Strong, $215-230\n‚Ä¢ PM: Competitive\n\nNext PPI: Jan 14, 2026\n\nKey factor: Mill maintenance schedules in Feb may tighten supply.';}if(ql.indexOf('occ')>-1){var best=buyers.filter(function(b){return b.prices&&b.prices.OCC;}).sort(function(a,b){return b.prices.OCC-a.prices.OCC;}).slice(0,5);return 'üì¶ Best OCC:\n\n'+best.map(function(b,i){return(i+1)+'. '+b.company+' - $'+b.prices.OCC;}).join('\n');}return 'ü§ñ Try:\n‚Ä¢ "Industry news"\n‚Ä¢ "PPI comparison"\n‚Ä¢ "Best OCC?"\n‚Ä¢ "Forecast"\n‚Ä¢ "Dark mode"';}
function openModal(id){if(!isAdmin){toast('Admin only');return;}editId=id||null;var md=document.getElementById('contactModal');document.getElementById('modalTitle').textContent=id?'Edit':'Add';if(id){var b=buyers.find(function(x){return x.id===id;});if(b){document.getElementById('fCompany').value=b.company||'';document.getElementById('fContact').value=b.contact||'';document.getElementById('fEmail').value=b.email||'';document.getElementById('fPhone').value=b.phone||'';document.getElementById('fType').value=b.type||'mill';['OCC','DLK','SWL','PM','CBS','HWEC'].forEach(function(c){var inp=document.getElementById('p'+c);if(inp)inp.value=b.prices&&b.prices[c]||'';});}}else{document.getElementById('contactForm').reset();}md.classList.add('active');}
function closeModal(){document.getElementById('contactModal').classList.remove('active');editId=null;}
function toggleSwitch(){document.getElementById('fPrioritySwitch').classList.toggle('active');}
function saveContact(){var pr={};['OCC','DLK','SWL','PM','CBS','HWEC'].forEach(function(c){var v=document.getElementById('p'+c).value;if(v)pr[c]=parseInt(v);});var d={company:document.getElementById('fCompany').value,contact:document.getElementById('fContact').value,email:document.getElementById('fEmail').value,phone:document.getElementById('fPhone').value,type:document.getElementById('fType').value,priority:document.getElementById('fPrioritySwitch').classList.contains('active'),commodities:Object.keys(pr),prices:pr};if(!d.company){toast('Company required');return;}if(editId){var ix=buyers.findIndex(function(b){return b.id===editId;});if(ix>-1)buyers[ix]=Object.assign({},buyers[ix],d);logActivity('Edited: '+d.company);}else{d.id=buyers.length+1;buyers.push(d);logActivity('Added: '+d.company);}saveData();closeModal();renderNav();render();toast('Saved');}
function editContact(id){openModal(id);}
function deleteContact(id){if(!isAdmin)return;var b=buyers.find(function(x){return x.id===id;});if(confirm('Delete '+b.company+'?')){buyers=buyers.filter(function(x){return x.id!==id;});saveData();logActivity('Deleted: '+b.company);renderNav();render();}}
init();
</script>
</body>
</html>
